namespace = bpm_frankfurt_parliament_events


# religious debate event
bpm_frankfurt_parliament_events.1 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.1.t
	desc = bpm_frankfurt_parliament_events.1.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {
		is_player = yes
		has_journal_entry = je_frankfurt_parliament
		has_global_variable = bpm_frankfurt_parliament_progress
		global_var:bpm_frankfurt_parliament_progress >= 10
		NOT = { has_global_variable = bpm_frankfurt_parliament_religious_law_chosen }
	}

	immediate = {
		if = { 
			limit = {
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_center_percent 
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_right_percent
			}
			set_global_variable = {
				name = bpm_frankfurt_parliament_religious_law_chosen
				value = law_type:law_total_separation
			}
		}

		else_if = {
			limit = { 
				global_var:bpm_frankfurt_parliament_right_percent >= global_var:bpm_frankfurt_parliament_center_percent 
				global_var:bpm_frankfurt_parliament_right_percent >= global_var:bpm_frankfurt_parliament_left_percent
			}
			set_global_variable = {
				name = bpm_frankfurt_parliament_religious_law_chosen
				value = law_type:law_state_religion
			}
		}

		else = {
			set_global_variable = {
				name = bpm_frankfurt_parliament_religious_law_chosen
				value = law_type:law_freedom_of_conscience
			}
		}

	}
	option = {
		name = bpm_frankfurt_parliament_events.1.a
		defult_option = yes
		
		custom_tooltip = {
			text = catholic_boycott_tt
			if = {
				limit = { global_var:bpm_frankfurt_parliament_religious_law_chosen = law_type:law_state_religion }
				every_country = {
					limit = {
						NOT = { has_variable = boycotting_frankfurt }
						OR = {
							country_has_primary_culture = cu:north_german
							country_has_primary_culture = cu:south_german
						}
						country_has_state_religion = rel:catholic
					}
					set_variable = boycotting_frankfurt
				}
			}
			bpm_frankfurt_member_update = yes
		}
	}
}

# speech debate event
bpm_frankfurt_parliament_events.2 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.2.t
	desc = bpm_frankfurt_parliament_events.2.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {
		is_player = yes
		has_journal_entry = je_frankfurt_parliament
		has_global_variable = bpm_frankfurt_parliament_progress
		global_var:bpm_frankfurt_parliament_progress >= 20
		NOT = { has_global_variable = bpm_frankfurt_parliament_speech_law_chosen }
		# has_global_variable = bpm_frankfurt_parliament_religious_law_chosen
	}

	immediate = {
		if = { 
			limit = {
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_center_percent 
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_right_percent
			}
			set_global_variable = {
				name = bpm_frankfurt_parliament_speech_law_chosen
				value = law_type:law_protected_speech
			}
		}
		else_if = {
			limit = {
				global_var:bpm_frankfurt_parliament_center_percent > global_var:bpm_frankfurt_parliament_left_percent
				global_var:bpm_frankfurt_parliament_center_percent >= global_var:bpm_frankfurt_parliament_right_percent
			}	
			set_global_variable = {
				name = bpm_frankfurt_parliament_speech_law_chosen
				value = law_type:law_right_of_assembly
			}
		}

		else = {
			set_global_variable = {
				name = bpm_frankfurt_parliament_speech_law_chosen
				value = law_type:law_censorship
			}
		}

	}
	option = {
		name = bpm_frankfurt_parliament_events.2.a
		defult_option = yes
		bpm_frankfurt_member_update = yes
	}
}

# centralization debate event
bpm_frankfurt_parliament_events.3 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.3.t
	desc = bpm_frankfurt_parliament_events.3.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {
		is_player = yes
		has_journal_entry = je_frankfurt_parliament
		has_global_variable = bpm_frankfurt_parliament_progress
		global_var:bpm_frankfurt_parliament_progress >= 30
		NOT = { has_global_variable = bpm_frankfurt_parliament_centralization_law_chosen }
		# has_global_variable = bpm_frankfurt_parliament_speech_law_chosen
		# has_global_variable = bpm_frankfurt_parliament_religious_law_chosen
	}

	immediate = {
		if = { 
			limit = {
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_center_percent 
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_right_percent
			}
			set_global_variable = {
				name = bpm_frankfurt_parliament_centralization_law_chosen
				value = law_type:law_unitary
			}
		}
		else_if = {
			limit = {
				global_var:bpm_frankfurt_parliament_center_percent > global_var:bpm_frankfurt_parliament_left_percent
				global_var:bpm_frankfurt_parliament_center_percent >= global_var:bpm_frankfurt_parliament_right_percent
			}	
			set_global_variable = {
				name = bpm_frankfurt_parliament_centralization_law_chosen
				value = law_type:law_federated
			}
		}

		else = {
			set_global_variable = {
				name = bpm_frankfurt_parliament_centralization_law_chosen
				value = law_type:law_confederated
			}
		}

	}
	option = {
		name = bpm_frankfurt_parliament_events.3.a
		defult_option = yes

		if = {
			limit = { global_var:bpm_frankfurt_parliament_centralization_law_chosen = law_type:law_unitary }
			every_country = {
				limit = {
					NOT = { has_variable = boycotting_frankfurt }
					OR = {
						country_has_primary_culture = cu:north_german
						country_has_primary_culture = cu:south_german
					}
					OR = {
						has_law = law_type:law_autocracy
						has_law = law_type:law_hereditary_bureaucrats
					}
				}
				set_variable = boycotting_frankfurt
			}
		}
		bpm_frankfurt_member_update = yes
	}
}

# bohemia debate event
bpm_frankfurt_parliament_events.4 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.4.t
	flavor = bpm_frankfurt_parliament_events.4.f
	desc = bpm_frankfurt_parliament_events.4.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {
		is_player = yes
		has_journal_entry = je_frankfurt_parliament
		has_global_variable = bpm_frankfurt_parliament_progress
		global_var:bpm_frankfurt_parliament_progress >= 40
		NOT = { has_global_variable = bpm_frankfurt_parliament_bohemia_status }
		# has_global_variable = bpm_frankfurt_parliament_centralization_law_chosen
		# has_global_variable = bpm_frankfurt_parliament_speech_law_chosen
		# has_global_variable = bpm_frankfurt_parliament_religious_law_chosen
	}

	immediate = {
		set_global_variable = {
			name = bpm_frankfurt_parliament_bohemia_status
		}
	}

	option = {
		name = bpm_frankfurt_parliament_events.4.a
		defult_option = yes

		# random_country = {
		# 	limit = { owns_entire_state_region = STATE_BOHEMIA }
		# 	trigger_event = { id = bpm_slavic.1 days = 7 popup = yes }
		# }
		bpm_frankfurt_member_update = yes
	}
}

# voting debate event
bpm_frankfurt_parliament_events.5 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.5.t
	desc = bpm_frankfurt_parliament_events.5.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {
		is_player = yes
		has_journal_entry = je_frankfurt_parliament
		has_global_variable = bpm_frankfurt_parliament_progress
		global_var:bpm_frankfurt_parliament_progress >= 50
		NOT = { has_global_variable = bpm_frankfurt_parliament_voting_law_chosen }
		# has_global_variable = bpm_frankfurt_parliament_bohemia_status
		# has_global_variable = bpm_frankfurt_parliament_centralization_law_chosen
		# has_global_variable = bpm_frankfurt_parliament_speech_law_chosen
		# has_global_variable = bpm_frankfurt_parliament_religious_law_chosen
	}

	immediate = {
		if = { 
			limit = {
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_center_percent 
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_right_percent
			}
			set_global_variable = {
				name = bpm_frankfurt_parliament_voting_law_chosen
				value = law_type:law_universal_suffrage
			}
		}
		else_if = {
			limit = {
				OR ={
					AND ={
						global_var:bpm_frankfurt_parliament_center_percent > global_var:bpm_frankfurt_parliament_left_percent
						global_var:bpm_frankfurt_parliament_center_percent >= global_var:bpm_frankfurt_parliament_right_percent
					}
					AND ={
						global_var:bpm_frankfurt_parliament_center_percent > global_var:bpm_frankfurt_parliament_left_percent
						global_var:bpm_frankfurt_parliament_left_percent > global_var:bpm_frankfurt_parliament_right_percent
					}
				}
			}	
			set_global_variable = {
				name = bpm_frankfurt_parliament_voting_law_chosen
				value = law_type:law_census_voting
			}
		}

		else = {
			set_global_variable = {
				name = bpm_frankfurt_parliament_voting_law_chosen
				value = law_type:law_landed_voting
			}
		}

	}
	option = {
		name = bpm_frankfurt_parliament_events.5.a
		defult_option = yes

		custom_tooltip = {
			text = autocracy_boycott_tt
			if = {
				limit = { global_var:bpm_frankfurt_parliament_voting_law_chosen = law_type:law_universal_suffrage }
				every_country = {
					limit = {
						NOT = { has_variable = boycotting_frankfurt }
						OR = {
							country_has_primary_culture = cu:north_german
							country_has_primary_culture = cu:south_german
						}
						NOT = {
							any_interest_group = {
								bpm_ig_is_left_wing = yes
								is_powerful = yes
							}
						}
						has_law = law_type:law_autocracy
					}
					set_variable = boycotting_frankfurt
				}
			}
		}

		custom_tooltip = {
			text = austria_boycott_tt
			if = {
				limit = { global_var:bpm_frankfurt_parliament_voting_law_chosen = law_type:law_census_voting }
				c:AUS = {
					limit = {
						NOT = { has_variable = boycotting_frankfurt }
						NOT = {
							OR = {
								any_interest_group = {
									bpm_ig_is_left_wing = yes
									is_powerful = yes
									is_in_government
								}
								bpm_country_is_republic = yes
							}
						}
					}
					set_variable = boycotting_frankfurt
				}
			}
		}
		
		bpm_frankfurt_member_update = yes
	}
}

# lesser/greater debate event
bpm_frankfurt_parliament_events.6 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.6.t
	desc = bpm_frankfurt_parliament_events.6.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {
		is_player = yes
		has_journal_entry = je_frankfurt_parliament
		has_global_variable = bpm_frankfurt_parliament_progress
		global_var:bpm_frankfurt_parliament_progress >= 60
		NOR = { 
			has_global_variable = bpm_frankfurt_parliament_lesser_germany
			has_global_variable = bpm_frankfurt_parliament_greater_germany
		}
		# has_global_variable = bpm_frankfurt_parliament_voting_law_chosen
		# has_global_variable = bpm_frankfurt_parliament_bohemia_status
		# has_global_variable = bpm_frankfurt_parliament_centralization_law_chosen
		# has_global_variable = bpm_frankfurt_parliament_speech_law_chosen
		# has_global_variable = bpm_frankfurt_parliament_religious_law_chosen
	}

	immediate = {
		if = { 
			limit = {
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_center_percent 
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_right_percent
			}
			set_global_variable = {
				name = bpm_frankfurt_parliament_greater_germany
			}
			c:AUS = {
				set_variable = boycotting_frankfurt
			}
			c:LUX = {
				set_variable = boycotting_frankfurt
			}
		}

		else = {
			set_global_variable = {
				name = bpm_frankfurt_parliament_lesser_germany
			}
		}

	}
	option = {
		name = bpm_frankfurt_parliament_events.6.a
		defult_option = yes
		bpm_frankfurt_member_update = yes
	}
}

# HoS event
bpm_frankfurt_parliament_events.7 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.7.t
	flavor = bpm_frankfurt_parliament_events.7.f
	desc = bpm_frankfurt_parliament_events.7.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {
		is_player = yes
		has_journal_entry = je_frankfurt_parliament
		has_global_variable = bpm_frankfurt_parliament_progress
		global_var:bpm_frankfurt_parliament_progress >= 70
		NOR = {
			has_global_variable = bpm_frankfurt_parliament_radical_win
			has_global_variable = bpm_frankfurt_parliament_moderate_win
			has_global_variable = bpm_frankfurt_parliament_conservative_win
		}
	}

	immediate = {
		if = { 
			limit = {
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_center_percent 
				global_var:bpm_frankfurt_parliament_left_percent >= global_var:bpm_frankfurt_parliament_right_percent
			}
			set_global_variable = {
				name = bpm_frankfurt_parliament_radical_win
			}
				every_country = {
					limit = {
						NOT = { has_variable = boycotting_frankfurt }
						is_subject = no
						OR = {
							country_has_primary_culture = cu:north_german
							country_has_primary_culture = cu:south_german
						}
						NOR = {
							has_law = law_type:law_presidential_republic
							has_law = law_type:law_parliamentary_republic
							any_interest_group = {
								OR = {
									bpm_ig_is_republican = yes
									bpm_ig_is_radical_left = yes
								}
								is_powerful = yes
							}
						}
					}
					set_variable = boycotting_frankfurt

					# iterates through non boycotting to find the highest ranked german tag
					ordered_country = {
						limit = {
							NOT = { has_variable = boycotting_frankfurt }
							OR = {
								country_has_primary_culture = cu:north_german
								country_has_primary_culture = cu:south_german
							}
							is_subject = no
						}
						order_by = country_rank
						save_scope_as = frankfurt_crown_candidate
						trigger_event = { id = bpm_frankfurt_parliament_events.11 }
					}
				}
		}
		else = {
			set_global_variable = {
				name = bpm_frankfurt_parliament_moderate_win
			}
			ordered_country = {
				limit = {
					NOT = { has_variable = boycotting_frankfurt }
					has_law = law_type:law_monarchy
					OR = {
						country_has_primary_culture = cu:north_german
						country_has_primary_culture = cu:south_german
					}
				}
				order_by = country_rank
        		save_scope_as = frankfurt_crown_candidate
			}
			
			scope:frankfurt_crown_candidate = {
				trigger_event = { id = bpm_frankfurt_parliament_events.8 }
			}
		}
	}
	option = {
		name = bpm_frankfurt_parliament_events.7.a
		trigger = {
			has_global_variable = bpm_frankfurt_parliament_moderate_win
		}
		custom_tooltip = {
			text = frankfurt_crown_candidate_tt
		}
		bpm_frankfurt_member_update = yes
	}
	option = {
		name = bpm_frankfurt_parliament_events.7.b
		trigger = {
			has_global_variable = bpm_frankfurt_parliament_radical_win
		}
		custom_tooltip = {
			text = frankfurt_republic_candidate_tt
		}
		bpm_frankfurt_member_update = yes
	}
}

bpm_frankfurt_parliament_events.8 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.8.t
	desc = bpm_frankfurt_parliament_events.8.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {

	}

	immediate = {
		
	}

	option = {
		name = bpm_frankfurt_parliament_events.8.a
		ai_chance = {
			base = 0
			modifier = {
				trigger = {
					ruler = {
						OR = {
							interest_group = bpm_ig_is_right_wing = no
							bpm_leader_is_liberal = yes
						}
					}
				}
				add = 40
			}
			modifier = {
				trigger = {
					ruler = {
						bpm_leader_is_hawkish = yes
					}
				}
				add = 15
			}
			modifier = {
				trigger = {
					ruler = {
						OR = {
							has_trait = ambitious
							has_trait = romantic
						}
					}
				}
				add = 20
			}
			modifier = {
				trigger = {
					ruler = {
						has_trait = trait_child
					}
				}
				add = -100
			}
		}
		change_tag = GER
		every_country = {
			limit = {
				NOT = { has_variable = boycotting_frankfurt }
				is_subject = no
				OR = {
					country_has_primary_culture = cu:north_german
					country_has_primary_culture = cu:south_german
				}
			}
			trigger_event = { id = bpm_frankfurt_parliament_events.101 }
		}
		
		bpm_frankfurt_member_update = yes
	}

	option = {
		name = bpm_frankfurt_parliament_events.8.b
		ai_chance = {
			base = 50
		}
		set_variable = boycotting_frankfurt
		ordered_country = {
			limit = {
				NOT = { has_variable = boycotting_frankfurt }
				is_subject = no
				has_law = law_type:law_monarchy
				OR = {
					country_has_primary_culture = cu:north_german
					country_has_primary_culture = cu:south_german
				}
			}
			order_by = country_rank
        	save_scope_as = frankfurt_crown_candidate
		}

		scope:frankfurt_crown_candidate = {
			trigger_event = { id = bpm_frankfurt_parliament_events.8 days = 2 }
		}
		bpm_frankfurt_member_update = yes
	}
}

bpm_frankfurt_parliament_events.9 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.9.t
	flavor = bpm_frankfurt_parliament_events.9.f
	desc = bpm_frankfurt_parliament_events.9.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {

	}

	immediate = {
		# set_global_variable = {
		# 	name = bpm_frankfurt_parliament_bohemia_status
		# }
	}

	option = {
		name = bpm_frankfurt_parliament_events.9.a
		defult_option = yes

		bpm_frankfurt_member_update = yes
	}
}

bpm_frankfurt_parliament_events.10 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.10.t
	flavor = bpm_frankfurt_parliament_events.10.f
	desc = bpm_frankfurt_parliament_events.10.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {

	}

	immediate = {
		# set_global_variable = {
		# 	name = bpm_frankfurt_parliament_bohemia_status
		# }
	}

	option = {
		name = bpm_frankfurt_parliament_events.10.a
		defult_option = yes

		bpm_frankfurt_member_update = yes
	}
}

bpm_frankfurt_parliament_events.11 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.11.t
	flavor = bpm_frankfurt_parliament_events.11.f
	desc = bpm_frankfurt_parliament_events.11.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {

	}

	immediate = {
		# set_global_variable = {
		# 	name = bpm_frankfurt_parliament_bohemia_status
		# }
	}

	option = {
		name = bpm_frankfurt_parliament_events.9.a
		defult_option = yes

		change_tag = GER
		every_country = {
			limit = {
				NOT = { has_variable = boycotting_frankfurt }
				is_subject = no
				OR = {
					country_has_primary_culture = cu:north_german
					country_has_primary_culture = cu:south_german
				}
			}
			trigger_event = { id = bpm_frankfurt_parliament_events.101 }
		}

		bpm_frankfurt_member_update = yes
	}
}

# debug event to get the je to show up
bpm_frankfurt_parliament_events.100 = {
	type = country_event
	placement = root
	title = bpm_frankfurt_parliament_events.100.t
	desc = bpm_frankfurt_parliament_events.100.d
	
	event_image = {
		video = "unspecific_politicians_arguing"
	}

	trigger = {
		always = no
	}


	option = {
		add_journal_entry = {
			type = je_frankfurt_parliament
		}
	}
}

# puppets non boycotting tags
bpm_frankfurt_parliament_events.101 = {
	type = country_event
	hidden = yes

	trigger = {

	}

	immediate = {
		scope:frankfurt_crown_candidate = {
			create_diplomatic_pact = {
				country = ROOT
				type = puppet
			}
		}
	}
}
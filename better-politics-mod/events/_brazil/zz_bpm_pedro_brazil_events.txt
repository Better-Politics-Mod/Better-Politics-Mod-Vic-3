namespace = pedro


# Landowners become republicans
pedro.2 = {
	type = country_event
	placement = ROOT
	
	title = pedro.2.t
	desc = pedro.2.d
	flavor = {
		first_valid = {
			triggered_desc = {
				desc = pedro.2.f
				trigger = {
					has_law = law_type:law_slavery_banned
				}
			}
			triggered_desc = {
				desc = pedro.2.f2
				trigger = {
					always = yes
				}
			}
		}
	}
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_default.dds"
	
	duration = 3

	#dlc = dlc008
	
	trigger = {
		 # triggered by je_pedro_brazil
		 root.var:pedropoints <= 2
		 ig:ig_landowners = {
		 	ig_approval <= unhappy
		 }
		 NOT = { has_variable = pedro_landowner_republicans }
	}

	immediate = {
		set_variable = pedro_landowner_republicans
		ruler = {
			save_scope_as = pedro_scope
		}
		ig:ig_landowners = {
			save_scope_as = landowners_scope
			leader = {
				save_scope_as = landowner_leader
			}
		}
		i:ideology_republican_paternalistic = {
			save_scope_as = elitist_scope
		}
	}

	option = {
		name = pedro.2.a
		default_option = yes
		ig:ig_landowners = {
			add_ideology = ideology_gov_radical_republican
			remove_ideology = ideology_gov_radical_monarchist
		}
	}
}

# The Monarchy is overthrown in a landowner/AF coup, ending event
pedro.8 = {
	type = country_event
	placement = ROOT
	
	title = pedro.8.t
	desc = pedro.8.d
	flavor = pedro.8.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"
	
	duration = 3

	#dlc = dlc008
	
	trigger = {
		# triggered by je_pedro_brazil		
	}

	immediate = {
		ig:ig_armed_forces = {
			save_scope_as = armed_forces_ig
		}
		ig:ig_landowners = {
			save_scope_as = landowners_ig
		}
		ruler = {
			save_scope_as = pedro_scope
		}
		ROOT = {
			save_scope_as = brazil_scope
		}
		if = {
			limit = {
				NOT = { has_law = law_type:law_landed_voting }
			}
			activate_law = law_type:law_landed_voting
		}
		activate_law = law_type:law_presidential_republic
	}

	option = {
		name = pedro.8.a
		default_option = yes
		hidden_effect = {
			ig:ig_landowners = {
				remove_ideology = ideology_eco_slave_economy
				add_ideology = ideology_dop_oligarch
				add_ideology = ideology_rel_secularist
				add_ideology = ideology_eco_traditional_agrarian
			}
		}
		if = {
			limit = {
				ig:ig_landowners = {
					is_in_government = no
					is_marginal = no
				}
			}
			ig:ig_landowners = {
				add_ruling_interest_group = yes
			}
		}
		if = {
			limit = {
				ig:ig_armed_forces = {
					is_in_government = no
					is_marginal = no
				}
			}
			ig:ig_armed_forces = {
				add_ruling_interest_group = yes
			}
		}
		if = {
			limit = {
				ig:ig_armed_forces = {
					is_marginal = no
				}
			}
			ig:ig_armed_forces = {
				leader = {
					set_character_as_ruler = yes
				}
			}
		}
		else = {
			ig:ig_landowners = {
				leader = {
					set_character_as_ruler = yes
				}
			}
		}
		add_radicals = {
			value = large_radicals
		}
		every_country = {
			limit = {
				NOT = {
					THIS = ROOT
				}
				has_interest_marker_in_region = region_brazil
			}
			post_notification = brz_brazil_coup
		}
	}
}

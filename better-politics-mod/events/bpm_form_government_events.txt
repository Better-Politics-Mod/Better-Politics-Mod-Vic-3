
namespace = bpm_form_government_events 

bpm_form_government_events.1 = {
	type = country_event
	placement = root
	title = bpm_form_government_events.1.t
	desc = bpm_form_government_events.1.d

    dlc = dlc_bpm


    on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
    on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

    icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

    duration = 2
    
	event_image = {
		video = "unspecific_politicians_arguing"
	}

    gui_window = event_window_form_government

    trigger = {
        # triggered by new ruler election
    }

    immediate = {
        ruler = {
            save_scope_as = bpm_new_ruler_scope
        }
        clear_variable_list = bpm_in_gov_party_sel
        remove_variable = bpm_in_gov_party_sel_votes
        bpm_calculate_selected_government_interparty_hostility = yes
        remove_modifier = bpm_synergy_from_government_hostility

    }

    option = {
        name = bpm_form_government_events.1.a
        #custom_tooltip = {
        #    text = bpm_form_government_events.1.a.tt
        #}
        if = {
            limit = {
                OR = { 
                    has_variable_list = bpm_in_gov_party_sel
                    variable_list_size = {
                        name = bpm_in_gov_party_sel
                        value > 0
                    }
                }
            }
            hidden_effect = {
                bpm_update_government_and_opposition = yes
                trigger_event = {
                    id = bpm_form_government_events.2
                    popup = yes
                }
            }    
            if = {
                limit = {
                    bpm_selected_government_interparty_hostility_value >= 10
                    bpm_selected_government_interparty_hostility_value < 20
                }
                add_modifier = {
                    name = bpm_synergy_from_government_hostility
                    multiplier = -0.1
                }
            }
            else_if ={
                limit = {
                    bpm_selected_government_interparty_hostility_value = 0
                }
                add_modifier = {
                    name = bpm_synergy_from_government_hostility
                    multiplier = 0.1
                }
            }
            else_if = {
                limit = {
                    bpm_selected_government_interparty_hostility_value >= 20
                    bpm_selected_government_interparty_hostility_value < 30
                }
                add_modifier = {
                    name = bpm_synergy_from_government_hostility
                    multiplier = -0.25
                }
            }
            else_if = {
                limit = { 
                    bpm_selected_government_interparty_hostility_value >= 30
                }
                add_modifier = {
                    name = bpm_synergy_from_government_hostility
                    multiplier = -0.5
                }
            }
        }
        else = {
            # long election campaign after a failed election
            owner = { call_election = {
                months = 12
            } }
            add_modifier = {
                name = bpm_synergy_from_government_hostility
                multiplier = -1
            }

        }

    }
}

bpm_form_government_events.2 = {
	type = country_event
	placement = root
	title = bpm_form_government_events.2.t
	desc = bpm_form_government_events.2.d

    dlc = dlc_bpm


    on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
    on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

    icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

    duration = 2
    
	event_image = {
		video = "unspecific_politicians_arguing"
	}

    gui_window = event_window_choose_pm

    trigger = {
        # triggered by new ruler election
        NOT = {
            has_variable = bpm_pm_lock
        }
    }

    immediate = {
        set_variable = bpm_pm_lock
        clear_variable_list = bpm_potential_headofgov
        every_interest_group = {
            limit = {
                is_in_government = yes
            }
            owner = {
                add_to_variable_list = {
                    name = bpm_potential_headofgov
                    target = prev.leader
                }
            }
        }
        set_variable = {
            name = bpm_choose_headofgov_carousel
            value = 0
        }
        hidden_effect = {
            bpm_get_picked_pm_util = yes
            set_variable = {
                name = bpm_carousel_current
                value = scope:result
            }
        }
    }

    option = {
        name = bpm_form_government_events.2.a
        custom_tooltip = {
            text = bpm_form_government_events.2.a.tt
        }
        hidden_effect = {
            remove_variable = bpm_pm_lock
            bpm_get_picked_pm_util = yes
        }
        scope:result = {
            bpm_appoint_as_hog = yes
            set_variable = bpm_rightfully_elected_headofgov
        }
    }
}

bpm_make_into_agitator = {
	clicksound = "event:/SFX/DLC/1.3_ip1/UI/character_invite"

	potential = {
		is_in_exile_pool = no
		is_in_void = no
		owner ?= { is_player = yes }
		is_ruler = no
		is_heir = no
		has_role = politician
		NOT = { has_role = agitator }
		interest_group = {
			NOT = { has_ideology = ideology:ideology_nonexistent }
		}
	}

	show_requirements = yes

	possible = {
		owner = { is_player = yes }
		scope:actor = { empty_agitator_slots >= 1 }
		interest_group = {
			bpm_ig_is_ideological = yes
			is_insurrectionary = no
		}
		NOT = { has_ideology = ideology:ideology_moderate }
	}

	effect = {
		#hidden_effect = {
			if = {
				limit = {
					NOT = { has_role = agitator }
				}
				add_character_role = agitator
			}
			if = {
				limit = {
					has_role = general
				}
				remove_character_role = general
			}
			if = {
				limit = {
					has_role = admiral
				}
				remove_character_role = admiral
			}
			if = {
				limit = {
					has_role = politician
				}
				set_as_interest_group_leader = no
				# remove_as_interest_group_leader = yes
				remove_character_role = politician
			}
			hidden_effect = {
				exile_character = yes
				transfer_character = scope:actor
			}
		#}
	}

	cooldown = { months = normal_modifier_time }
	show_confirmation_box = yes

	ai_chance = {
		value = -50
	}
}

bpm_add_to_cabinet = {
	clicksound = "event:/SFX/DLC/1.3_ip1/UI/character_invite"
	potential = {
		save_temporary_scope_as = tempactor
		owner ?= { 
			has_variable = bpm_cabinet_char_select 
			
			OR = {
				is_target_in_variable_list = {
					name = bpm_CAB_char_select_pool		
					target = scope:tempactor
				}
				is_target_in_variable_list = {
					name = bpm_CAB_leader_select_pool		
					target = scope:tempactor
				}
			}
		} 
	}

	show_requirements = yes

	possible = {
		save_temporary_scope_as = tempactor

		trigger_if = {
			limit = {
				NOT = {
					owner = { 
						is_target_in_variable_list = {
							name = bpm_CAB_char_select_pool
							target = scope:tempactor
						}
					}
				}
			}
			custom_tooltip = {
				text = bpm_add_to_cabinet_possible_leader_everyfouryears_tt
				NOT = { owner = { has_variable = bpm_cant_pick_leader_cab } }
			}
		}
		trigger_else = {
			custom_tooltip = {
				text = bpm_add_to_cabinet_tt
				always = yes
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = bpm_add_to_cabinet_effect_tt
			save_scope_as = actor
			if = {
				limit = {
					owner = { NOT = {
						is_target_in_variable_list = {
							name = bpm_CAB_char_select_pool
							target = scope:actor
						}
					} }
				}
				custom_tooltip = {
					text = bpm_cant_pick_leader_cab_for_4_years_tt
					owner = { set_variable = {
						name = bpm_cant_pick_leader_cab
						days = 1460
					} }
				}
	
			}
			owner ?= {
				remove_list_variable = {
					name = bpm_CAB_char_select_pool
					target = scope:actor
				}
			}
			bpm_add_character_to_cabinet = yes
		}

		if = {
			limit = {
				popularity > 0
			}
			add_loyalists = {
				value = {
					value = popularity
					divide = 100
					multiply = 0.5
				}
				interest_group = interest_group
			}
		}
		else = {
			add_radicals = {
				value = {
					value = popularity
					divide = 100
					multiply = -0.3
				}
			}
		}
		interest_group = {
			add_modifier = {
				name = bpm_recently_assigned_to_cabinet
				months = short_modifier_time
				is_decaying = yes
			}
		}
	}

	#cooldown = none, the cooldown is to remove the character from cabinet
	show_confirmation_box = no
}

bpm_remove_from_cabinet = {
	clicksound = "event:/SFX/DLC/1.3_ip1/UI/character_invite"
	potential = {
		has_variable = bpm_cabinet_minister
		#is_in_void = yes
	}

	show_requirements = yes

	possible = {
		custom_tooltip = {
			text = bpm_remove_from_cabinet_tt
			always = yes
		}
		
	}

	effect = {
		bpm_fire_cabinet_minister = yes
	}

	cooldown = { months = 2 } #TODO: replace with removable cooldown based on elections

	show_confirmation_box = no
}


#bpm_add_to_pool = {
#	clicksound = "event:/SFX/DLC/1.3_ip1/UI/character_invite"
#
#	potential = {
#		is_in_exile_pool = no
#		is_in_void = no
#		owner ?= { is_player = yes }
#		is_ruler = no
#		is_heir = no
#		has_role = politician
#		owner = { has_variable = bpm_has_cabinet }
#		NOT = { 
#			OR = {
#				is_target_in_variable_list = {
#					name = bpm_CAB_char_select_pool
#					target = scope:actor
#				}
#				has_variable = bpm_cabinet_minister
#			}
#		}
#	}
#
#	show_requirements = yes
#
#	possible = {
#		owner = { is_player = yes }
#		interest_group = {
#			is_insurrectionary = no
#			custom_tooltip = {
#				text = bpm_add_to_pool_possible_radical_tt
#				bpm_ig_is_radical_opposition = no
#				bpm_ig_is_very_radical_opposition = no	
#			}
#		}
#	}
#
#	effect = {
#		#hidden_effect = {
#			save_scope_as = actor
#			place_character_in_void = 10000
#			#set_variable = bpm_send_to_void_if_not_anchored
#			owner = { 
#				add_to_variable_list = {
#					name = bpm_CAB_char_select_pool
#					target = scope:actor
#				}
#			}
#		#}
#	}
#
#	cooldown = { months =  short_modifier_time }#6 }
#	show_confirmation_box = no
#}

bpm_minister_take_over_ig = {
	clicksound = "event:/SFX/DLC/1.3_ip1/UI/character_invite"

	potential = {
		has_variable = bpm_cabinet_minister
		exists = owner
		owner = { has_variable = bpm_has_cabinet }
		is_in_void = yes
		NOT = { 
			this ?= interest_group.leader
		}
	}


	show_requirements = yes

	possible = {
		custom_tooltip = {
			text = bpm_minister_take_over_ig_possible_tt
			always = yes
		}
	}

	effect = {
		#hidden_effect = {
			free_character_from_void = yes
			set_as_interest_group_leader = yes
			custom_tooltip = {
				text = bpm_remove_from_cabinet_effect_tt
				bpm_remove_character_from_cabinet = yes
			}
		#}
	}

	cooldown = { months = normal_modifier_time }
	show_confirmation_box = no
}
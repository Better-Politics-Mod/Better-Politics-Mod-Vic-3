bpm_setup_global_laws_varlists = {
    bpm_setup_foundations_varlist = yes
    bpm_setup_repeatables_varlist = yes
    #clear_variable_list = bpm_laws_foundation_category
    #clear_variable_list = bpm_laws_repeatable_category
}


bpm_setup_foundations_varlist = {
    # Foundations laws
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_monarchy
    }
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_presidential_republic
    }
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_parliamentary_republic
    }
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_theocracy
    }
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_council_republic
    }
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_appointed_by_hos
    }
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_appointed_on_advice
    }
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_no_separate_hog
    }
    add_to_global_variable_list = {
        name = bpm_laws_foundation_category
        target = law_type:law_answers_to_legislature
    }

}

bpm_setup_repeatables_varlist = {
    # Repeatable laws
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_culture_none
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_culture_invite_foreign_experts
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_culture_promote_democratic_values
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_culture_promote_absolutist_values
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_culture_promote_patriotic_values
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_culture_promote_socialist_values
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_culture_promote_ultranationalist_values
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_economy_none
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_economy_liberalization
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_economy_agricultural_investment
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_economy_peasant_corvee
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_economy_public_works
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_economy_forced_industrialization
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_military_none
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_military_military_reform
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_military_parades_and_drills
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_military_improve_soldier_conditions
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_military_army_defunding
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_military_war_propaganda
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_politics_none
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_politics_modernize_bureaucracy
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_politics_military_purge
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_politics_bureaucratic_purge
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_politics_popular_concessions
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_politics_anti_corruption_drive
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_politics_great_terror
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_religion_none
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_religion_anti_secular_reaction
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_religion_promote_state_religion
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_religion_promote_secular_values
	}
	add_to_global_variable_list = {
		name = bpm_laws_repeatable_category
		target = law_type:law_repeatable_religion_anti_religious_violence
	}
}

bpm_set_sta_ideology = {
    bpm_remove_all_sta_ideologies = yes
    add_ideology = ideology_sta_$ideology$_state
    bpm_reorder_ideologies = yes
}

bpm_update_sta_ideology = {
    if = {
        limit = {
            OR = {
                has_law = law_type:law_monarchy
                has_law = law_type:law_theocracy
                AND = {
                    OR = {
                        has_law = law_type:law_presidential_republic
                        has_law = law_type:law_parliamentary_republic
                    }
                    country_has_voting_franchise = no
                }
            }
        }
        if = {
            limit = {
                # is crisis?
                bpm_is_crisis_or_sticky = no
            }
            every_interest_group = {
                bpm_update_sta_ideology_non_crisis_monarchy = yes
            }
            
        } 
        else = {
            every_interest_group = {
                bpm_update_sta_ideology_non_crisis_monarchy = yes
                bpm_update_sta_ideology_crisis_monarchy = yes
            }
        }
    }
    else_if = {
        limit = {
            OR = {
                has_law = law_type:law_presidential_republic
                has_law = law_type:law_parliamentary_republic
            }
            country_has_voting_franchise = yes
        }
        if = {
            limit = {
                # is crisis?
                bpm_is_crisis_or_sticky = no
            }
            every_interest_group = {
                bpm_update_sta_ideology_non_crisis_republic = yes
            }
        } 
        else = {
            every_interest_group = {
                bpm_update_sta_ideology_non_crisis_republic = yes
                bpm_update_sta_ideology_crisis_republic = yes
            }
        }
    }
    else_if = {
        limit = {
            has_law = law_type:law_council_republic
        }
        if = {
            limit = {
                # is crisis?
                bpm_is_crisis_or_sticky = no
            }
            every_interest_group = {
                bpm_update_sta_ideology_non_crisis_council_republic = yes
            }
        } 
        else = {
            every_interest_group = {
                bpm_update_sta_ideology_non_crisis_council_republic = yes
                bpm_update_sta_ideology_crisis_council_republic = yes
            }
        }
    }
}

bpm_update_sta_ideology_crisis_council_republic = {
    if = {
        limit = {
            is_interest_group_type = ig_revolutionist_socialists
        }
        bpm_set_sta_ideology = {
            ideology = subjugated_security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_socialists
        }
        bpm_set_sta_ideology = {
            ideology = subjugated_security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_armed_forces
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_devout
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_trade_unions
        }
        bpm_set_sta_ideology = {
            ideology = subjugated_security
        }
    }
}

bpm_update_sta_ideology_crisis_republic = {
    if = {
        limit = {
            is_interest_group_type = ig_conservatives
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_fascists
        }
        bpm_set_sta_ideology = {
            ideology = organic
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_liberals
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_market_liberals
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_radicals
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reactionaries
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reformist_socialists
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_armed_forces
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_devout
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_trade_unions
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
}

bpm_update_sta_ideology_crisis_monarchy = {
    if = {
        limit = {
            is_interest_group_type = ig_conservatives
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_fascists
        }
        bpm_set_sta_ideology = {
            ideology = organic
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_liberals
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_market_liberals
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_national_liberals
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reactionaries
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_armed_forces
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_devout
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
}

bpm_update_sta_ideology_non_crisis_republic = {
    if = {
        limit = {
            is_interest_group_type = ig_agrarian_populists
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_anarchists
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_conservatives
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_fascists
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_liberals
        }
        if = {
            limit = {

                owner = {
                    OR = {
                        has_law = law_type:law_confederated
                        has_law = law_type:law_federated
                    }
                }
            }
            bpm_set_sta_ideology = {
                ideology = federated
            }
        }
        else = {
            bpm_set_sta_ideology = {
                ideology = powerful
            }
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_market_liberals
        }
        if = {
            limit = {

                owner = {
                    OR = {
                        has_law = law_type:law_confederated
                        has_law = law_type:law_federated
                    }
                }
            }
            bpm_set_sta_ideology = {
                ideology = federated
            }
        }
        else = {
            bpm_set_sta_ideology = {
                ideology = powerful
            }
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_national_liberals
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_radicals
        }
        if = {
            limit = {
                owner = {
                    country_has_voting_franchise = yes
                }
            }
            bpm_set_sta_ideology = {
                ideology = progressive
            }
        }
        else = {
            bpm_set_sta_ideology = {
                ideology = weak
            }
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reactionaries
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reformist_socialists
        }
        if = {
            limit = {
                owner = {
                    country_has_voting_franchise = yes
                }
            }
            bpm_set_sta_ideology = {
                ideology = progressive
            }
        }
        else = {
            bpm_set_sta_ideology = {
                ideology = weak
            }
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_revolutionist_socialists
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_socialists
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_armed_forces
        }
        bpm_set_sta_ideology = {
            ideology = institutional
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_devout
        }
        bpm_set_sta_ideology = {
            ideology = institutional
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_intelligentsia
        }
        bpm_set_sta_ideology = {
            ideology = institutional
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_landowners
        }
        bpm_set_sta_ideology = {
            ideology = institutional
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_petty_bourgeoisie
        }
        bpm_remove_all_sta_ideologies = yes
        bpm_reorder_ideologies = yes
    }
    if = {
        limit = {
            is_interest_group_type = ig_rural_folk
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_trade_unions
        }
        if = {
            limit = {
                owner = {
                    country_has_voting_franchise = yes
                }
            }
            bpm_set_sta_ideology = {
                ideology = progressive
            }
        }
        else = {
            bpm_set_sta_ideology = {
                ideology = weak
            }
        }
    }
}

bpm_update_sta_ideology_non_crisis_monarchy = {
    if = {
        limit = {
            is_interest_group_type = ig_agrarian_populists
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_anarchists
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_conservatives
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_fascists
        }
        bpm_set_sta_ideology = {
            ideology = security
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_liberals
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_market_liberals
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_national_liberals
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_radicals
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reactionaries
        }
        bpm_set_sta_ideology = {
            ideology = powerful
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reformist_socialists
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_revolutionist_socialists
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_socialists
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_armed_forces
        }
        bpm_set_sta_ideology = {
            ideology = institutional
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_devout
        }
        bpm_set_sta_ideology = {
            ideology = institutional
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_intelligentsia
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_landowners
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_petty_bourgeoisie
        }
        bpm_remove_all_sta_ideologies = yes
        bpm_reorder_ideologies = yes
    }
    if = {
        limit = {
            is_interest_group_type = ig_rural_folk
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_trade_unions
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
}

bpm_update_sta_ideology_non_crisis_council_republic = {
    if = {
        limit = {
            is_interest_group_type = ig_agrarian_populists
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_anarchists
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_conservatives
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_fascists
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_liberals
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_market_liberals
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_national_liberals
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_radicals
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reactionaries
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_reformist_socialists
        }
        bpm_set_sta_ideology = {
            ideology = weak
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_revolutionist_socialists
        }
        bpm_set_sta_ideology = {
            ideology = subjugated
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_socialists
        }
        bpm_set_sta_ideology = {
            ideology = subjugated
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_armed_forces
        }
        bpm_set_sta_ideology = {
            ideology = institutional
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_devout
        }
        bpm_set_sta_ideology = {
            ideology = institutional
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_intelligentsia
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_landowners
        }
        bpm_set_sta_ideology = {
            ideology = minimal
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_petty_bourgeoisie
        }
        bpm_remove_all_sta_ideologies = yes
        bpm_reorder_ideologies = yes
    }
    if = {
        limit = {
            is_interest_group_type = ig_rural_folk
        }
        bpm_set_sta_ideology = {
            ideology = decentralized
        }
    }
    if = {
        limit = {
            is_interest_group_type = ig_trade_unions
        }
        bpm_set_sta_ideology = {
            ideology = subjugated
        }
    }
}
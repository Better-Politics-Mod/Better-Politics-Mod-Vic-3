namespace = bpm_codification_events


bpm_codification_events.1 = { 

    type = country_event
	placement = ROOT
	
	title = bpm_codification_events.1.t
	#desc = bpm_codification_events.1.d
    flavor = bpm_codification_events.1.f
    desc = {
		first_valid = {
            triggered_desc = {
				desc = bpm_codification_events_kinghog_desc
				trigger = {
					bpm_ruler_hog_balance = yes
				}
			}
			triggered_desc = {
				desc = bpm_codification_events_king_desc
				trigger = {
					bpm_ruler_is_dominant = yes
				}
			}
			triggered_desc = {
				desc = bpm_codification_events_hog_desc
				trigger = {
					bpm_hog_is_dominant = yes
				}
			}
		}
	}
	#flavor = bpm_cabinet_event.1.f
	
	event_image = {
		video = "ep1_transfer_of_authority"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"
	
	duration = 3

    trigger = {
        NOT = { has_variable = bpm_decree_cooldown }
    }

	immediate = { 
		set_variable = {
			name = bpm_decree_cooldown
			value = scope:bpm_selected_law.type
		}
		random_law = {
			limit = {
				owner = {
					has_law = prev.type
				}
				type = {
					is_same_law_group_as = scope:bpm_selected_law.type
				}
			}
			save_scope_as = bpm_current_law
		}
		set_variable = {
			name = bpm_decree_cooldown_current_law
			value = scope:bpm_current_law.type
		}
	}

    option = {
        name = bpm_codification_events.1.a
        activate_law = scope:bpm_selected_law.type
		hidden_effect = { 
			bpm_determine_coup_severity = yes
		}
        save_scope_as = associated_country
        scope:bpm_selected_law.type = { 
            bpm_codification_set_decree = yes
        }
        custom_tooltip = bpm_codification_events_dangerous_tooltip
    }

    option = {
        name = bpm_codification_events.1.b
        custom_tooltip = bpm_codification_events_preparation_tooltip
    }

    option = {
        name = bpm_codification_events.1.c
        custom_tooltip = bpm_codification_events_cancel_tooltip
		remove_variable = bpm_decree_cooldown
    }
}

# failure
bpm_codification_events.2 = {
	type = country_event
	placement = ROOT
	
	title = bpm_codification_events.2.t
	desc = bpm_codification_events.2.d
    flavor = bpm_codification_events.2.f

	event_image = {
		video = "ep1_transfer_of_authority"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	immediate = {
		# probably trigger a hidden event to remove it later
		trigger_event = { id = bpm_codification_events.100 days = 180 }
		
	}

	duration = 1

	option = {
		name = bpm_codification_events.2.a
		activate_law = var:bpm_decree_cooldown_current_law
	}
}

# success 
bpm_codification_events.3 = {
	type = country_event
	placement = ROOT
	
	title = bpm_codification_events.3.t
	desc = bpm_codification_events.3.d
	flavor = bpm_codification_events.3.f

	event_image = {
		video = "ep1_transfer_of_authority"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	immediate = {
		# probably trigger a hidden event to remove it later
		remove_variable = bpm_decree_cooldown
		trigger_event = { id = bpm_codification_events.100 days = 180 }
	}

	duration = 1

	option = {
		name = bpm_codification_events.3.a
		#TODO: add authority and popularity and IG clout
	}
}

bpm_codification_events.100 = {
	type = country_event
	placement = root
	hidden = yes

	immediate = {
		remove_variable = bpm_decree_cooldown
	}
}
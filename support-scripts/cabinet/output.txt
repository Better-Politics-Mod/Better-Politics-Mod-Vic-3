bpm_remove_institution_modifiers_home_affairs = {
   remove_modifier = bpm_home_affairs_agpops_modifier
   remove_modifier = bpm_home_affairs_leftists_modifier
   remove_modifier = bpm_home_affairs_cons_modifier
   remove_modifier = bpm_home_affairs_reacs_modifier
   remove_modifier = bpm_home_affairs_liberals_modifier
   remove_modifier = bpm_home_affairs_pseudoleft_modifier
   remove_modifier = bpm_home_affairs_military_modifier
   remove_modifier = bpm_home_affairs_pb_modifier
   remove_modifier = bpm_home_affairs_neutraling_modifier
   remove_modifier = bpm_home_affairs_capis_modifier
   remove_modifier = bpm_home_affairs_intel_modifier
}


bpm_reload_institution_modifiers_home_affairs = {
    institution:institution_home_affairs ?= {
        bpm_remove_institution_modifiers_home_affairs = yes
    }
    if = {
        limit = {
            var:bpm_is_institution_home_affairs ?= {
                OR = {
                    is_character_alive = no
                    NOT = { exists = interest_group } 
                }
            }
        }
        remove_variable = bpm_is_institution_home_affairs
    }
    if = {
        limit = {
            has_variable = bpm_is_institution_home_affairs
        }
        var:bpm_is_institution_home_affairs.interest_group = {
           bpm_reload_modifier_inst_singlet = {
                IG1 = conservatives
                INST = home_affairs
                MOD = bpm_home_affairs_cons_modifier
            }
           bpm_reload_modifier_inst_triplet = {
                IG1 = liberals
                IG2 = market_liberals
                IG3 = national_liberals
                INST = home_affairs
                MOD = bpm_home_affairs_liberals_modifier
            }
           bpm_reload_modifier_inst_triplet = {
                IG1 = radicals
                IG2 = reformist_socialists
                IG3 = socialists
                INST = home_affairs
                MOD = bpm_home_affairs_pseudoleft_modifier
            }
           bpm_reload_modifier_inst_triplet = {
                IG1 = devout
                IG2 = rural_folk
                IG3 = trade_unions
                INST = home_affairs
                MOD = bpm_home_affairs_neutraling_modifier
            }
           bpm_reload_modifier_inst_doublet = {
                IG1 = industrialists
                IG2 = landowners
                INST = home_affairs
                MOD = bpm_home_affairs_capis_modifier
            }
            if = {
                limit = {
                    has_law = law_type:law_guaranteed_liberties
                }
                bpm_reload_modifier_inst_singlet = {
                    IG1 = agrarian_populists
                    INST = home_affairs
                    MOD = bpm_home_affairs_agpops_modifier
                }
               bpm_reload_modifier_inst_doublet = {
                    IG1 = anarchists
                    IG2 = revolutionist_socialists
                    INST = home_affairs
                    MOD = bpm_home_affairs_leftists_modifier
                }
                bpm_reload_modifier_inst_singlet = {
                    IG1 = intelligentsia
                    INST = home_affairs
                    MOD = bpm_home_affairs_intel_modifier
                }
                bpm_reload_modifier_inst_singlet = {
                    IG1 = petty_bourgeoisie
                    INST = home_affairs
                    MOD = bpm_home_affairs_neutraling_modifier
                }
            }
            else = {
                bpm_reload_modifier_inst_singlet = {
                    IG1 = petty_bourgeoisie
                    INST = home_affairs
                    MOD = bpm_home_affairs_pb_modifier
                }
                bpm_reload_modifier_inst_singlet = {
                    IG1 = intelligentsia
                    INST = home_affairs
                    MOD = bpm_home_affairs_neutraling_modifier
                }
                bpm_reload_modifier_inst_doublet = {
                    IG1 = fascists
                    IG2 = reactionaries
                    INST = home_affairs
                    MOD = bpm_home_affairs_reacs_modifier
                }
                bpm_reload_modifier_inst_singlet = {
                    IG1 = armed_forces
                    INST = home_affairs
                    MOD = bpm_home_affairs_military_modifier
                }
            }


            add_modifier = {
                name = bpm_home_affairs_attraction_modifier
                multiplier = institution:institution_home_affairs.investment
            }
        }
    }
}

bpm_is_institution_home_affairs_modifier = {
    type = character
    random_valid = no

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_agrarian_populists
                }
            }
        }
        localization_key = bpm_home_affairs_agpops_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_anarchists
                    is_interest_group_type = ig_revolutionist_socialists
                }
                has_law = law_type:law_guaranteed_liberties
            }
        }
        localization_key = bpm_home_affairs_leftists_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_conservatives
                }
            }
        }
        localization_key = bpm_home_affairs_cons_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_fascists
                    is_interest_group_type = ig_reactionaries
                }
                NOT = { has_law = law_type:law_guaranteed_liberties }
            }
        }
        localization_key = bpm_home_affairs_reacs_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_liberals
                    is_interest_group_type = ig_market_liberals
                    is_interest_group_type = ig_national_liberals
                }
            }
        }
        localization_key = bpm_home_affairs_liberals_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_radicals
                    is_interest_group_type = ig_reformist_socialists
                    is_interest_group_type = ig_socialists
                }
            }
        }
        localization_key = bpm_home_affairs_pseudoleft_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_armed_forces
                }
                NOT = { has_law = law_type:law_guaranteed_liberties }
            }
        }
        localization_key = bpm_home_affairs_military_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_petty_bourgeoisie
                }
                NOT = { has_law = law_type:law_guaranteed_liberties }
            }
        }
        localization_key = bpm_home_affairs_pb_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_devout
                    is_interest_group_type = ig_rural_folk
                    is_interest_group_type = ig_trade_unions
                    AND = {
                        NOT = { has_law = law_type:law_guaranteed_liberties }
                        is_interest_group_type = ig_petty_bourgeoisie
                    }
                    AND = { 
                        has_law = law_type:law_guaranteed_liberties
                        is_interest_group_type = ig_intelligentsia
                    }
                }
            }
        }
        localization_key = bpm_home_affairs_neutraling_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_industrialists
                    is_interest_group_type = ig_landowners
                }
            }
        }
        localization_key = bpm_home_affairs_capis_modifier_desc
    }

    text = {
        trigger = {
            interest_group = {
                OR = {
                    is_interest_group_type = ig_intelligentsia
                }
                has_law = law_type:law_guaranteed_liberties
            }
        }
        localization_key = bpm_home_affairs_intel_modifier_desc
    }
}
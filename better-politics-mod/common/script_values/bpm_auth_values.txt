bpm_auth_state_exhaustion_rate = {
	value = 0
	subtract = bpm_auth_weekly_state_exhaustion_recovery

	every_scope_state = {
		add = modifier:state_bpm_auth_state_exhaustion_weekly_add
	}

	if = {
		limit = {
			is_player = yes # AI might be too stupid not to kill itself with this
		}
		add = bpm_auth_exhaustion_from_army
	}
}

bpm_auth_weekly_state_exhaustion_recovery = {
	value = 40

	if = {
		limit = {
			has_variable = bpm_auth_state_exhaustion
			var:bpm_auth_state_exhaustion >= 500
		}

		add = -20
	}
	if = {
		limit = {
			has_variable = bpm_auth_state_exhaustion
			var:bpm_auth_state_exhaustion >= 1000
		}

		add = -10
	}
	if = {
		limit = {
			is_player = no
		}

		add = 20 # we love cheating AI folks
	}
}

bpm_auth_collapsed_states_effect_power = {
	value = 0
	every_scope_state = {
		if = {
			limit = { 
				is_incorporated = yes
				OR = {
					bpm_auth_state_has_collapsed_auth = yes
					bpm_auth_state_has_partisans = yes
				}
			}
			
			add = 1
		}
	}

	divide = {
		value = 0
		every_scope_state = {
			if = {
				limit = { 
					OR = {
						is_incorporated = yes
						is_capital = yes # I'm doing this just in case, somehow, a country has no incorporated states which would end up crashing the game if true due to division by zero
					}
				}
				
				add = 1
			}
		}
	}
}

bpm_auth_exhaustion_from_army = {
	value = 0

	if = {
		limit = { army_size > 0 }

		every_military_formation = {
			limit = {
				is_army = yes
				is_mobilized = yes
			}
			add = num_units
		}
	
		divide = army_size

		multiply = bpm_auth_weekly_state_exhaustion_from_raised_army
	}
}

# On a scale from 0 to 100 how much do the locals hate the new regime
bpm_auth_partisan_factor = {
	value = turmoil
	multiply = 100

	# MOUNTAINS (and forests i guess)
	if = {
		limit = { bpm_auth_partisans_love_terrain = yes }
	 	add = 50
	} else_if = {
		limit = { bpm_auth_partisans_like_terrain = yes }
		add = 10
	}

	#if = {
	#	limit = { has_modifier = recently_conquered_state }
	#	min = 60 # if partisans spawn from conquest, they are guaranteed to have at least some bite
	#}

	#if = {
	#	limit = { bpm_auth_partisans_can_be_strong = no }
	#	max = 50 # clamping partisans that don't fit the bill
	#}
}
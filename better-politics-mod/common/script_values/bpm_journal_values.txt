bpm_je_propaganda_of_the_deed_philosophy_value = {
	value = 0
	if = {
		limit = { has_variable = bpm_je_propaganda_of_the_deed }
		add = var:bpm_je_propaganda_of_the_deed
	}
}

bpm_je_propaganda_of_the_deed_months_below_value = {
	value = 0
	if = {
		limit = { has_variable = bpm_je_propaganda_of_the_deed_months_below }
		add = var:bpm_je_propaganda_of_the_deed_months_below
	}
}

bpm_je_propaganda_of_the_deed_decay_threshold_value = {
	value = 50
	add = {
		if = {
			limit = { has_variable = bpm_je_propaganda_of_the_deed_bombs_done }
			add = var:bpm_je_propaganda_of_the_deed_bombs_done
			multiply = 4
		}
	}
}

bpm_je_propaganda_of_the_deed_complete_threshold_value = {
	value = 100
	add = {
		if = {
			limit = { has_variable = bpm_je_propaganda_of_the_deed_bombs_done }
			add = var:bpm_je_propaganda_of_the_deed_bombs_done
			multiply = -4
		}
	}
}

bpm_je_propaganda_of_the_deed_baseline_target = {
	value = 0

	add = {
		desc = "BPM_VALUE_BASE"
		value = 10
	}

	# Repressive police/secret police laws
	add = {
		desc = "BPM_VALUE_FROM_INSTITUTION_LOCAL_POLICE"
		if = {
			limit = { has_law = law_type:law_local_police }
			add = institution:institution_police.investment
			multiply = 4
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_INSTITUTION_NATIONAL_POLICE"
		if = {
			limit = { has_law = law_type:law_dedicated_police }
			add = institution:institution_police.investment
			multiply = 4
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_INSTITUTION_MILITARIZED_POLICE"
		if = {
			limit = { has_law = law_type:law_militarized_police	}
			add = institution:institution_police.investment
			multiply = 5
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_INSTITUTION_NATIONAL_GUARD"
		if = {
			limit = { has_law = law_type:law_national_guard }
			add = institution:institution_home_affairs.investment
			multiply = 4
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_INSTITUTION_SECRET_POLICE"
		if = {
			limit = { has_law = law_type:law_secret_police }
			add = institution:institution_home_affairs.investment
			multiply = 5
		}
	}

	# Autocratic laws or flawed electoral laws
	add = {
		desc = "BPM_VALUE_FROM_LAW_NO_ELECTIONS"
		if = {
			limit = { 
				bpm_country_laws_no_voting = yes
			}
			add = 15
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_NO_FULL_DEMOCRACY"
		if = {
			limit = { 
				bpm_country_laws_no_voting = no
				NOT = { 
					has_law = law_type:law_universal_suffrage
					institution:institution_suffrage.investment = 5 
				}
			}
			add = 10
		}
	}

	# Low rigidity
	add = {
		desc = "BPM_VALUE_FROM_RIGIDITY"
		add = 50
		subtract = var:bpm_political_stability
		multiply = 0.2
		min = 0
	}

	# Discriminatory laws
	add = {
		desc = "BPM_VALUE_FROM_LAW_STATE_RELIGION"
		if = {
			limit = { has_law = law_type:law_state_religion }
			add = 5
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_STATE_ATHEISM"
		if = {
			limit = { has_law = law_type:law_state_atheism }
			add = 5
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_NO_MULTICULTURALISM"
		if = {
			limit = { NOT = { has_law = law_type:law_multicultural } }
			add = 10
		}
	}

	# Anti-proletarian laws (socialist party bans, zero or weak welfare, traditionalism/LF, serfdom, no free time etc)
	add = {
		desc = "BPM_VALUE_FROM_LAW_SOCIALIST_BAN"
		if = {
			limit = { bpm_banned_socialist_parties = yes }
			add = 15
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_NO_WELFARE"
		if = {
			limit = { has_law = law_type:law_no_social_security } 
			add = 5
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_POOR_LAWS"
		if = {
			limit = { has_law = law_type:law_poor_laws } 
			add = 5
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_TRADITIONALISM"
		if = {
			limit = { has_law = law_type:law_traditionalism } 
			add = 10
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_LAISSEZ_FAIRE"
		if = {
			limit = { has_law = law_type:law_laissez_faire } 
			add = 10
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_INTERVENTIONISM"
		if = {
			limit = { has_law = law_type:law_interventionism } 
			add = 5
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_SERFDOM"
		if = {
			limit = { has_law = law_type:law_serfdom } 
			add = 15
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_TENANT_FARMERS"
		if = {
			limit = { has_law = law_type:law_tenant_farmers } 
			add = 5
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_COMMERCIALIZED_AGRICULTURE"
		if = {
			limit = { has_law = law_type:law_commercialized_agriculture } 
			add = 5
		}
	}
	#add = {
	#	desc = "BPM_VALUE_FROM_LAW_HOMESTEADING"
	#	if = {
	#		limit = { has_law = law_type:law_homesteading } 
	#		add = 5
	#	}
	#}
	add = {
		desc = "BPM_VALUE_FROM_LAW_UNREGULATED_WORK_TIME"
		if = {
			limit = { has_law = law_type:law_unregulated_work_time } 
			add = 5
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_LAW_NO_WORKERS_RIGHTS"
		if = {
			limit = { has_law = law_type:law_no_workers_rights } 
			add = 5
		}
	}

	# Foreign Policy
	add = {
		desc = "BPM_VALUE_FROM_WAR"
		if = {
			limit = { is_at_war = yes }
			add = 25
		}
	}

	# Duration of JE (lowers resting point over time by 1 per month generally)
	# subtract = {
	# 	desc = "BPM_VALUE_JOURNAL_DURATION"
	# 	add = var:bpm_je_propaganda_of_the_deed_exhaustion
	# }

	# Another GP finished the JE
	# subtract = {
	# 	desc = "BPM_VALUE_POTD_ENDED_IN_GP"
	# 	if = {
	# 		limit = { has_global_variable = bpm_anarchist_potd_ended_in_gp }
	# 		add = 25
	# 	}
	# }
	
	# Anarchist agitators
	add = {
		desc = "BPM_VALUE_ANARCHIST_AGITATORS"
		every_scope_character = {
			limit = {
				has_role = agitator
				is_interest_group_type = ig_anarchists
			}
			add = popularity
			multiply = 0.1
		}
	}

	# Bombs done
	#if = {
	#	limit = { is_player = no }
	#	add = {
	#		desc = "BPM_VALUE_FROM_PREV_BOMBS"
	#		add = var:bpm_je_propaganda_of_the_deed_bombs_done
	#		multiply = -10
	#	}
	#}
}

bpm_je_propaganda_of_the_deed_бомбометр_rate_true = {
	add = bpm_je_propaganda_of_the_deed_бомбометр_rate
	if = {
		limit = {
			has_variable = bpm_je_propaganda_of_the_deed
			var:bpm_je_propaganda_of_the_deed < bpm_je_propaganda_of_the_deed_decay_threshold_value
		}
		multiply = {
			desc = "BPM_POTD_STRENGTH_TOO_LOW"
			value = 0
		}
	}
}

bpm_je_propaganda_of_the_deed_бомбометр_rate = {
	add = {
		desc = "BPM_VALUE_BASE"
		value = 5
	}

	# Strong Anarchists
	add = {
		desc = "BPM_VALUE_POWERFUL_ANARCHISTS"
		if = {
			limit = {
				ig:ig_anarchists ?= {
					is_powerful = yes
				}
			}
			add = 5
		}
	}

	# Bolstered Anarchists
	# add = {
	# 	desc = "BPM_VALUE_BOLSTERED_ANARCHISTS"
	# 	if = {
	# 		limit = {
	# 			ig:ig_anarchists ?= {
	# 				is_being_bolstered = yes
	# 			}
	# 		}
	# 		add = 5
	# 	}
	# }

	# Anarchist Agitators
	add = {
		desc = "BPM_VALUE_ANARCHIST_AGITATORS"
		every_scope_character = {
			limit = {
				has_role = agitator
				is_interest_group_type = ig_anarchists
			}
			add = popularity
			multiply = 0.4
			min = 10
		}
	}

	# PotD progress (Above 50%) (Multiplies above)
	multiply = {
		desc = "BPM_VALUE_FROM_POTD_CONVICTION"
		add = var:bpm_je_propaganda_of_the_deed
		subtract = 50
		divide = 50
		# multiply = 2
		add = 1
		min = 1
	}

	# Rigidity
	#add = {
	#	desc = "BPM_VALUE_FROM_RIGIDITY"
	#	add = 50
	#	subtract = var:bpm_political_stability
	#	multiply = 0.05
	#}

	
	# Cops & Secret Cops
	subtract = {
		desc = "BPM_VALUE_FROM_INSTITUTION_LOCAL_POLICE"
		if = {
			limit = { has_law = law_type:law_local_police }
			add = institution:institution_police.investment
			multiply = 0.5
		}
	}
	subtract = {
		desc = "BPM_VALUE_FROM_INSTITUTION_NATIONAL_POLICE"
		if = {
			limit = { has_law = law_type:law_dedicated_police }
			add = institution:institution_police.investment
		}
	}
	subtract = {
		desc = "BPM_VALUE_FROM_INSTITUTION_MILITARIZED_POLICE"
		if = {
			limit = { has_law = law_type:law_militarized_police	}
			add = institution:institution_police.investment
			multiply = 2
		}
	}
	subtract = {
		desc = "BPM_VALUE_FROM_INSTITUTION_NATIONAL_GUARD"
		if = {
			limit = { has_law = law_type:law_national_guard }
			add = institution:institution_home_affairs.investment
		}
	}
	subtract = {
		desc = "BPM_VALUE_FROM_INSTITUTION_SECRET_POLICE"
		if = {
			limit = { has_law = law_type:law_secret_police }
			add = institution:institution_home_affairs.investment
			multiply = 2
		}
	}
}

bpm_je_agrarian_socialism_rate = {
	value = 0

	add = {
		desc = "BPM_VALUE_BASE"
		value = -1
	}

	# Laws
	if = {
		limit = { has_law = law_type:law_traditionalism }
		add = {
			desc = "BPM_VALUE_FROM_LAW_TRADITIONALISM"
			value = 0.4
		}
	}
	else_if = {
		limit = { has_law = law_type:law_agrarianism }
		add = {
			desc = "BPM_VALUE_FROM_LAW_AGRARIANISM"
			value = 0.4
		}
	}

	if = {
		limit = { has_law = law_type:law_tenant_farmers }
		add = {
			desc = "BPM_VALUE_FROM_LAW_TENANT_FARMERS"
			value = 0.4
		}
	}
	else_if = {
		limit = { has_law = law_type:law_serfdom }
		add = {
			desc = "BPM_VALUE_FROM_LAW_SERFDOM"
			value = 1.0
		}
	}
	else_if = {
		limit = { has_law = law_type:law_homesteading }
		add = {
			desc = "BPM_VALUE_FROM_LAW_HOMESTEADING"
			value = -0.5
		}
	}

	# Agitators & Leaders
	add = {
		desc = "BPM_VALUE_FROM_AGRARIAN_SOCIALIST_CHARACTERS"
		every_scope_character = {
			limit = {
				has_ideology = ideology:ideology_agrarian_socialist_leader
				OR = {
					has_role = politician
					has_role = agitator
				}
			}
			add = popularity
			min = 0
		}
		multiply = 0.005
	}

	# Peasant population yandev
	if = {
		limit = { has_variable = bpm_peasant_population_yandev_var }
		add = {
			desc = "BPM_VALUE_FROM_PEASANT_POPULATION"
			value = var:bpm_peasant_population_yandev_var
			multiply = 0.04
		}
	}

	# Farmer population yandev
	# add = {
	# 	desc = "BPM_VALUE_FROM_FARMER_POPULATION"
	# 	if = {
	# 		limit = { pop_type_percent_country = { pop_type = farmers percent > 0.3 } }
	# 		if = {
	# 			limit = { pop_type_percent_country = { pop_type = farmers percent > 0.5 } }
	# 			add = 5
	# 		}
	# 		else_if = {
	# 			limit = { pop_type_percent_country = { pop_type = farmers percent > 0.4 } }
	# 			add = 4
	# 		}
	# 		else = {
	# 			add = 3
	# 		}
	# 	}
	# 	else = {
	# 		if = {
	# 			limit = { pop_type_percent_country = { pop_type = farmers percent > 0.2 } }
	# 			add = 2
	# 		}
	# 		else_if = {
	# 			limit = { pop_type_percent_country = { pop_type = farmers percent > 0.1 } }
	# 			add = 1
	# 		}
	# 	}
	# 	multiply = 0.05
	# }

	# Radicals yandev
	if = {
		limit = { has_variable = bpm_peasant_radicals_yandev_var }
		add = {
			desc = "BPM_VALUE_FROM_PEASANT_RADICALS"
			value = var:bpm_peasant_radicals_yandev_var
			multiply = 0.20
		}
	}
	# add = {
	# 	desc = "BPM_VALUE_FROM_FARMER_RADICALS"
	# 	if = {
	# 		limit = { radical_fraction = { pop_type = farmers value > 0.4 } }
	# 		if = {
	# 			limit = { radical_fraction = { pop_type = farmers value > 0.8 } }
	# 			add = 8
	# 		}
	# 		else_if = {
	# 			limit = { radical_fraction = { pop_type = farmers value > 0.6 } }
	# 			add = 6
	# 		}
	# 		else = {
	# 			add = 4
	# 		}
	# 	}
	# 	else = {
	# 		if = {
	# 			limit = { radical_fraction = { pop_type = farmers value > 0.2 } }
	# 			add = 2
	# 		}
	# 		else_if = {
	# 			limit = { radical_fraction = { pop_type = farmers value > 0.1 } }
	# 			add = 1
	# 		}	
	# 	}

	# 	multiply = 0.10
	# }

	# Other Journal factors
	# add = {
	# 	desc = "BPM_VALUE_FROM_NOT_POTD_COMPLETED"
	# 	if = {
	# 		limit = { NOT = { has_variable = bpm_anarchist_potd_ended } } 
	# 		add = -0.1
	# 	}
	# }
	add = {
		desc = "BPM_VALUE_FROM_SYNDICALISM_DEVELOPMENT"
		if = {
			limit = { has_variable = bpm_je_syndicalism } 
			subtract = var:bpm_je_syndicalism
			multiply = 0.02
		}
	}
}

bpm_je_syndicalism_rate = {

	value = 0

	add = {
		desc = "BPM_VALUE_BASE"
		value = -0.4
	}

	if = {
		limit = { exists = ig:ig_socialists }
		add = {
			desc = "BPM_VALUE_FROM_SOCS_POPULARITY"
			value = ig:ig_socialists.interest_group_population_percentage
			multiply = -15
		}
	}
	if = {
		limit = { exists = ig:ig_revolutionist_socialists }
		add = {
			desc = "BPM_VALUE_FROM_REVSOCS_POPULARITY"
			value = ig:ig_revolutionist_socialists.interest_group_population_percentage
			multiply = -15
		}
	}
	if = {
		limit = { exists = ig:ig_trade_unions }
		add = {
			desc = "BPM_VALUE_FROM_TRADE_UNIONS_POPULARITY"
			value = ig:ig_trade_unions.interest_group_population_percentage
			multiply = 20
		}
	}

	# Agitators & Leaders
	add = {
		desc = "BPM_VALUE_FROM_SYNDICALIST_CHARACTERS"
		every_scope_character = {
			limit = {
				OR = {
					has_ideology = ideology:ideology_syndicalist
					has_ideology = ideology:ideology_anarchist_syndicalist
				}
				OR = {
					has_role = politician
					has_role = agitator
				}
			}
			add = popularity
			min = 0
		}
		multiply = 0.005
	}

	# Laborer population yandev
	if = {
		limit = { has_variable = bpm_laborer_population_yandev_var }
		add = {
			desc = "BPM_VALUE_FROM_LABORER_POPULATION"
			value = var:bpm_laborer_population_yandev_var
			multiply = 0.05
		}
	}

	# Machinist population yandev
	if = {
		limit = { has_variable = bpm_machinist_population_yandev_var }
		add = {
			desc = "BPM_VALUE_FROM_MACHINIST_POPULATION"
			value = var:bpm_machinist_population_yandev_var
			multiply = 0.2
		}
	}

	# Laborer radicals yandev
	if = {
		limit = { has_variable = bpm_laborer_radicals_yandev_var }
		add = {
			desc = "BPM_VALUE_FROM_LABORER_RADICALS"
			value = var:bpm_laborer_radicals_yandev_var
			multiply = 0.10
		}
	}
	
	# Machinist radicals yandev
	if = {
		limit = { has_variable = bpm_machinist_radicals_yandev_var }
		add = {
			desc = "BPM_VALUE_FROM_MACHINIST_RADICALS"
			value = var:bpm_machinist_radicals_yandev_var
			multiply = 0.10
		}
	}

	# Other Journal factors
	# add = {
	# 	desc = "BPM_VALUE_FROM_POTD_COMPLETED"
	# 	if = {
	# 		limit = { has_variable = bpm_anarchist_potd_ended } 
	# 		add = 0.8
	# 	}
	# }
	add = {
		desc = "BPM_VALUE_FROM_SYNDICALISM_LEGITIMIZED"
		if = {
			limit = { has_global_variable = bpm_syndicalism_legitimized } 
			add = 0.8
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_FAILED_SYNDICALIST_STRIKES"
		if = {
			subtract = var:bpm_syndicalist_strikes_failed
			multiply = 0.4
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_AGRARIAN_SOCIALISM_DEVELOPMENT"
		if = {
			limit = { has_variable = bpm_je_agrarian_socialism } 
			subtract = var:bpm_je_agrarian_socialism
			multiply = 0.02
		}
	}
}

bpm_je_zapadniks_and_slavophiles_rate_prog_rubberband_zapadnik = {
	value = 2
	subtract = {
		if = {
			limit = { has_variable = bpm_je_zapadniks_and_slavophiles }
			add = var:bpm_je_zapadniks_and_slavophiles
		}
		subtract = 50
		divide = 50
		min = 0
	}
	divide = 2
}

bpm_je_zapadniks_and_slavophiles_rate_prog_rubberband_slavophile = {
	value = 1
	add = {
		if = {
			limit = { has_variable = bpm_je_zapadniks_and_slavophiles }
			add = var:bpm_je_zapadniks_and_slavophiles
		}
		divide = 50
		min = 0
	}
	divide = 2
}

bpm_je_zapadniks_and_slavophiles_rate = {
	value = 0

	if = {
		limit = {
			var:bpm_je_zapadniks_and_slavophiles_duration < 1920 # 40~ish years (4 weeks per 12 months = 48; 48 * 40 years = 1920 weeks)
		}
		# Tsar + Leaders & Agitators (Slavophiles)
		subtract = {
			desc = "BPM_VALUE_FROM_MONARCH_POPULARITY"
			if = {
				limit = { has_law = law_type:law_monarchy }
				add = {
					value = ruler.popularity
					multiply = 0.002
					multiply = bpm_je_zapadniks_and_slavophiles_rate_prog_rubberband_slavophile	
				}
			}
		}
		subtract = {
			desc = "BPM_VALUE_FROM_REACTIONARY_LEADER_AND_AGITATORS"
			every_scope_character = {
				limit = {
					is_interest_group_type = ig_reactionaries
					OR = {
						has_role = politician
						has_role = agitator
					}
				}
				add = popularity
			}
			multiply = 0.002
			multiply = bpm_je_zapadniks_and_slavophiles_rate_prog_rubberband_slavophile
		}
		subtract = {
			desc = "BPM_VALUE_FROM_CONSERVATIVE_LEADER_AND_AGITATORS"
			every_scope_character = {
				limit = {
					is_interest_group_type = ig_conservatives
					OR = {
						has_role = politician
						has_role = agitator
					}
				}
				add = popularity
			}
			multiply = 0.002
			multiply = bpm_je_zapadniks_and_slavophiles_rate_prog_rubberband_slavophile
		}
	
		# Leaders & Agitators (Zapadnik)
		add = {
			desc = "BPM_VALUE_FROM_LIBERAL_LEADER_AND_AGITATORS"
			every_scope_character = {
				limit = {
					is_interest_group_type = ig_liberals
					OR = {
						has_role = politician
						has_role = agitator
					}
				}
				add = popularity
			}
			multiply = 0.002
			multiply = bpm_je_zapadniks_and_slavophiles_rate_prog_rubberband_zapadnik
		}
		add = {
			desc = "BPM_VALUE_FROM_RADICAL_LEADER_AND_AGITATORS"
			every_scope_character = {
				limit = {
					is_interest_group_type = ig_radicals
					OR = {
						has_role = politician
						has_role = agitator
					}
				}
				add = popularity
			}
			multiply = 0.002
			multiply = bpm_je_zapadniks_and_slavophiles_rate_prog_rubberband_zapadnik
		}
		add = {
			desc = "BPM_VALUE_FROM_SOCIALIST_LEADER_AND_AGITATORS"
			every_scope_character = {
				limit = {
					is_interest_group_type = ig_socialists
					OR = {
						has_role = politician
						has_role = agitator
					}
				}
				add = popularity
			}
			multiply = 0.002
			multiply = bpm_je_zapadniks_and_slavophiles_rate_prog_rubberband_zapadnik
		}
		multiply = {
			desc = "BPM_VALUE_JOURNAL_DURATION"
			add = 1920
			subtract = var:bpm_je_zapadniks_and_slavophiles_duration
			divide = 1920
		}
	} else = {
		# Going back to resting point
		add = {
			desc = "BPM_VALUE_JOURNAL_DURATION"
			if = {
				limit = { has_variable = bpm_je_zapadniks_and_slavophiles }
				subtract = var:bpm_je_zapadniks_and_slavophiles
			}
			add = 50
			max = 1
			min = -1
		}
	}

}

bpm_je_general_strike_multiplier = { # 
	value = 1
	if = {
		limit = { has_journal_entry = je_bpm_general_strike_ongoing }
		multiply = 0.05
	}
}

bpm_je_general_strike_trigger_progress_baseline_target = {
	value = bpm_je_general_strike_power
}

bpm_je_general_strike_quadratic_trade_union_support = {
	# 0.1 * (x^2 - 10x + 25)
	value = 0
	add = {
		value = ig_approval
		multiply = ig_approval
	}
	subtract = {
		value = ig_approval
		multiply = 10
	}
	add = 25
	multiply = 0.01
	max = 1
	min = 0
}

bpm_je_general_strike_power = {
	value = 0

	if = {
		limit = {
			is_at_war = no
			NOT = {
				any_interest_group = {
					bpm_ig_is_labor = yes
					interest_group_supports_political_movement = yes
				}
			}
			NOT = { has_journal_entry = je_bpm_general_strike_ongoing }
		}
		subtract = {
			desc = "BPM_VALUE_FROM_NO_GOAL"
			value = 100
		}
	}
	else = {
		if = {
			limit = {
				is_at_war = no
				NOT = {
					any_interest_group = {
						bpm_ig_is_labor = yes
						interest_group_supports_political_movement = yes
					}
				}
				has_journal_entry = je_bpm_general_strike_ongoing
			}
			subtract = {
				desc = "BPM_VALUE_FROM_NO_GOAL"
				value = 100
			}
		}
		add = {
			desc = "BPM_VALUE_RANDOM"
			if = {
				limit = { has_variable = bpm_je_general_strike_trigger_random }
			}
			value = var:bpm_je_general_strike_trigger_random
		}

		# Population too agrarian
		add = {
			desc = "BPM_VALUE_FROM_PEASANT_POPULATION"
			if = {
				limit = {
					has_variable = bpm_peasant_population_yandev_var
				}
				subtract = var:bpm_peasant_population_yandev_var
				multiply = 2
			}
		}

		# No Labor Confederations
		add = {
			desc = "BPM_VALUE_FROM_NO_TECH_ANARCHISM"
			if = {
				limit = { NOT = { has_technology_researched = anarchism } } 
				subtract = 25
			}
		}

		if = {
			limit = { NOT = { has_law = law_type:law_syndicalism } }
			# Syndicalist agitators & Syndicalism progress
			add = {
				desc = "BPM_VALUE_FROM_SYNDICALISM_DEVELOPMENT"
				if = {
					limit = { has_variable = bpm_je_syndicalism } 
					add = var:bpm_je_syndicalism
					multiply = 0.1
				}
			}
			add = {
				desc = "BPM_VALUE_FROM_SYNDICALIST_CHARACTERS"
				every_scope_character = {
					limit = {
						OR = {
							has_ideology = ideology:ideology_syndicalist
							has_ideology = ideology:ideology_anarchist_syndicalist
						}
						OR = {
							has_role = politician
							has_role = agitator
						}
					}
					add = popularity
					min = 0
				}
				multiply = 0.1
				max = 10
			}
			# add = {
			# 	desc = "BPM_VALUE_FROM_SYNDICALISM_LEGITIMIZED"
			# 	if = {
			# 		limit = { has_global_variable = bpm_syndicalism_legitimized } 
			# 		add = 20
			# 	}
			# }
		}

		# Socialist/TU IG Popularity (& anger potentially)
		add = {
			desc = "BPM_VALUE_FROM_SOCIALISTS_APPROVAL_POPULARITY"
			every_interest_group = {
				limit = {
					bpm_ig_is_socialist = yes
					ig_approval < 5
				}
				add = {
					value = bpm_je_general_strike_quadratic_trade_union_support
					# Scale by population
					multiply = interest_group_population_percentage
					multiply = 100
				}
			}
			max = 20 # Cap at 20% of population (all socialists)
			min = 0
		}
		add = {
			desc = "BPM_VALUE_FROM_TRADE_UNIONS_APPROVAL_POPULARITY"
			if = {
				limit = {
					ig:ig_trade_unions = {
						ig_approval < 5
					}
				}
				ig:ig_trade_unions ?= {
					add = bpm_je_general_strike_quadratic_trade_union_support
					# Scale by population
					multiply = interest_group_population_percentage
					multiply = 100
					max = 10 # Cap at 10% of population
					min = 0
				}
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_TRADE_UNIONS_APPROVAL_CLOUT"
			if = {
				limit = {
					ig:ig_trade_unions = {
						ig_approval < 5
					}
				}
				ig:ig_trade_unions ?= {
					add = bpm_je_general_strike_quadratic_trade_union_support
					# Scale by population
					multiply = ig_clout
					multiply = 100
					max = 10 # Cap at 10% of clout
					min = 0
				}
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_POPULAR_ANGRY_TRADE_UNIONS"
			if = {
				limit = {
					ig:ig_trade_unions = {
						bpm_ig_is_popular = yes
						ig_approval <= angry
					}
				}
				add = 20
			}
		}

		# Radicals vs Loyalists
		add = {
			desc = "BPM_VALUE_FROM_RADICALS"
			add = radical_fraction
			multiply = 80
		}
		add = {
			desc = "BPM_VALUE_FROM_LOYALISTS"
			subtract = loyalist_fraction
			multiply = 40
		}

		# War
		if = {
			limit = { is_at_war = yes }
			if = {
				limit = {
					any_scope_war = {
						has_war_support = {
							target = root
							value > 66
						}
					}
				}
				add = {
					value = 0
					desc = "BPM_VALUE_FROM_WAR_HIGH_SUPPORT"
				}
			} else_if = {
				limit = {
					any_scope_war = {
						has_war_support = {
							target = root
							value > 33
						}
					}
				}
				add = {
					value = 10
					desc = "BPM_VALUE_FROM_WAR_MEDIUM_SUPPORT"
				}
			} else_if = {
				limit = {
					any_scope_war = {
						has_war_support = {
							target = root
							value > 0
						}
					}
				}
				add = {
					value = 20
					desc = "BPM_VALUE_FROM_WAR_LOW_SUPPORT"
				}
			} else = {
				add = {
					value = 30
					desc = "BPM_VALUE_FROM_WAR_VERY_LOW_SUPPORT"
				}
			}
		}

		# Progress of progressive Revolution (Liberal or Socialist)
		if = {
			limit = { NOT = { has_law = law_type:law_council_republic } }
			add = {
				desc = "BPM_VALUE_FROM_ONGOING_LIBERAL_REVOLUTION"
				if = {
					limit = { liberal_revolution_ongoing = yes socialist_revolution_ongoing = no }
					every_civil_war = {
						limit = { is_civil_war_type = revolution }
						add = civil_war_progress
						multiply = 75
					}
				}
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_ONGOING_SOCIALIST_REVOLUTION"
			if = {
				limit = { socialist_revolution_ongoing = yes }
				every_civil_war ={
					limit = { is_civil_war_type = revolution }
					add = civil_war_progress
					multiply = 100
				}
			}
		}

		# Labor laws (Doesn't affect active strike)	
		if = {
			limit = {
				always = no
				NOT = { has_journal_entry = je_bpm_general_strike_ongoing }
			}
			# Labor time laws
			if = {
				limit = { has_law = law_type:law_token_time_regulations }
				subtract = {
					desc = "[GetLawType('law_token_time_regulations').GetName] [concept_investment_level]"
					value = institution:institution_workplace_safety.investment
					multiply = 1
				}
			}
			else_if = {
				limit = { has_law = law_type:law_limited_work_hours }
				subtract = {
					desc = "[GetLawType('law_limited_work_hours').GetName] [concept_investment_level]"
					value = institution:institution_workplace_safety.investment
					multiply = 2
				}
			}
			else_if = {
				limit = { has_law = law_type:law_protected_leisure }
				subtract = {
					desc = "[GetLawType('law_protected_leisure').GetName] [concept_investment_level]"
					value = institution:institution_workplace_safety.investment
					multiply = 4
				}
			}
			# Labor laws
			if = {
				limit = { has_law = law_type:law_regulatory_bodies }
				subtract = {
					desc = "[GetLawType('law_regulatory_bodies').GetName] [concept_investment_level]"
					value = institution:institution_workplace_safety.investment
					multiply = 1
				}
			}
			else_if = {
				limit = { has_law = law_type:law_worker_protections }
				subtract = {
					desc = "[GetLawType('law_worker_protections').GetName] [concept_investment_level]"
					value = institution:institution_workplace_safety.investment
					multiply = 2
				}
			}

			if = {
				limit = { has_law = law_type:law_local_police }
				subtract = {
					desc = "BPM_VALUE_FROM_INSTITUTION_LOCAL_POLICE"
					value = institution:institution_police.investment
					multiply = 0.1
				}
			}
			else_if = {
				limit = { has_law = law_type:law_dedicated_police }
				subtract = {
					desc = "BPM_VALUE_FROM_INSTITUTION_NATIONAL_POLICE"
					value = institution:institution_police.investment
					multiply = 0.2
				}
			}
			else_if = {
				limit = { has_law = law_type:law_militarized_police }
				subtract = {
					desc = "BPM_VALUE_FROM_INSTITUTION_MILITARIZED_POLICE"
					value = institution:institution_police.investment
					multiply = 0.5
				}
			}
			# Home affairs
			if = {
				limit = { has_law = law_type:law_national_guard }
				subtract = {
					desc = "BPM_VALUE_FROM_INSTITUTION_NATIONAL_GUARD"
					value = institution:institution_home_affairs.investment
					multiply = 0.2
				}
			}
			else_if = {
				limit = { has_law = law_type:law_secret_police }
				subtract = {
					desc = "BPM_VALUE_FROM_INSTITUTION_SECRET_POLICE"
					value = institution:institution_home_affairs.investment
					multiply = 0.2
				}
			}
			# Union Laws
			if = {
				limit = { has_law = law_type:law_state_controlled_labor_unions }
				subtract = {
					desc = "BPM_VALUE_FROM_LAW_STATE_CONTROLLED_LABOR_UNIONS"
					add = {
						value = -20
					}
				}
			}
			else_if = {
				limit = { has_law = law_type:law_limited_labor_unions }
				subtract = {
					desc = "BPM_VALUE_FROM_LAW_LIMITED_LABOR_UNIONS"
					add = {
						value = -10
					}
				}
			}

		}

		# Rev/RefSocs in government (in non-CRs)
		if = {
			limit = { ig:ig_revolutionist_socialists ?= { is_in_government = yes } }
			subtract = {
				desc = "BPM_VALUE_REVOLUTIONIST_SOCIALISTS_IN_GOVERNMENT"
				value = 20
			}
		}
		else_if = {
			limit = { ig:ig_socialists ?= { is_in_government = yes } }
			subtract = {
				desc = "BPM_VALUE_SOCIALISTS_IN_GOVERNMENT"
				value = 15
			}
		}
		else_if = {
			limit = { ig:ig_reformist_socialists ?= { is_in_government = yes } }
			subtract = {
				desc = "BPM_VALUE_REFORMIST_SOCIALISTS_IN_GOVERNMENT"
				value = 10
			}
		}
	}

	# Strike Exhaustion
	add = {
		desc = "BPM_VALUE_STRIKE_EXHAUSTION"
		if = {
			limit = { has_variable = bpm_je_general_strike_exhaustion }
		}
		subtract = var:bpm_je_general_strike_exhaustion
	}

	multiply = {
		value = bpm_je_general_strike_multiplier
	}

	if = {
		limit = {
			NOT = { has_journal_entry = je_bpm_general_strike_ongoing }
		}
		min = 0
	}
	max = 101
}

bpm_je_general_strike_exhaustion_rate = {
	value = 0

	add = {
		desc = "BPM_VALUE_BASE"
		value = 0
		if = {
			limit = { has_journal_entry = je_bpm_general_strike_trigger }
			add = {
				value = var:bpm_je_general_strike_exhaustion
				multiply = -0.03
			}
			max = -3
		} else = {
			add = 6
		}
	}

	if = {
		limit = { has_journal_entry = je_bpm_general_strike_ongoing }
		if = {
			limit = {
				has_journal_entry = je_bpm_general_strike_ongoing
				has_variable = bpm_je_general_strike_power_cached
				var:bpm_je_general_strike_power_cached < 0
			}
			add = {
				desc = "BPM_VALUE_FROM_RETREATING_STRIKERS"
				value = 10
			}
		}
	
		# Larger and more powerful unions exhaust less
		add = {
			desc = "BPM_VALUE_FROM_TRADE_UNION_POPULARITY"
			ig:ig_trade_unions ?= {
				subtract = interest_group_population_percentage
				multiply = 100
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_TRADE_UNION_CLOUT"
			ig:ig_trade_unions ?= {
				subtract = ig_clout
				multiply = 100
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_SOCIALIST_IGS_POPULARITY"
			every_interest_group = {
				limit = { bpm_ig_is_socialist = yes }
				add = {
					subtract = interest_group_population_percentage
					multiply = 100
				}
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_CONTENT_LABOR_IGS"
			value = 0
			every_interest_group = {
				limit = {
					bpm_ig_is_labor = yes
					ig_approval >= 0
				}
				add = 3
			}
		}
	
		# Police exhausts protests faster
		add = {
			desc = "BPM_VALUE_FROM_INSTITUTION_LOCAL_POLICE"
			if = {
				limit = { 
					has_law = law_type:law_local_police  
					has_journal_entry = je_bpm_general_strike_ongoing
				}
				add = institution:institution_police.investment
				multiply = 1
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_INSTITUTION_NATIONAL_POLICE"
			if = {
				limit = { 
					has_law = law_type:law_dedicated_police 
					has_journal_entry = je_bpm_general_strike_ongoing
				}
				add = institution:institution_police.investment
				multiply = 2
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_INSTITUTION_MILITARIZED_POLICE"
			if = {
				limit = { 
					has_law = law_type:law_militarized_police  
					has_journal_entry = je_bpm_general_strike_ongoing
				}
				add = institution:institution_police.investment
				multiply = 5
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_INSTITUTION_NATIONAL_GUARD"
			if = {
				limit = { 
					has_law = law_type:law_national_guard
					has_journal_entry = je_bpm_general_strike_ongoing
				}
				add = institution:institution_home_affairs.investment
				multiply = 2
			}
		}
		add = {
			desc = "BPM_VALUE_FROM_INSTITUTION_SECRET_POLICE"
			if = {
				limit = { 
					has_law = law_type:law_secret_police
					has_journal_entry = je_bpm_general_strike_ongoing
				}
				add = institution:institution_home_affairs.investment
				multiply = 2
			}
		}
	
		# Aside from Elected Police
		subtract = {
			desc = "BPM_VALUE_FROM_INSTITUTION_ELECTED_POLICE"
			if = {
				limit = { 
					has_law = law_type:law_elected_police 
					has_journal_entry = je_bpm_general_strike_ongoing
				}
				add = institution:institution_police.investment
				multiply = 5
				multiply = bpm_je_general_strike_multiplier
			}
		}
	
		if = {
			limit = { 
				has_journal_entry = je_bpm_general_strike_ongoing
				has_revolution = no
			}
			min = -1
		} 
	
		if = {
			desc = "BPM_MAX_EXHAUSTION_RATE_IN_REVOLUTION"
			limit = { 
				has_journal_entry = je_bpm_general_strike_ongoing
				has_revolution = yes
			}
			max = 0
		} 	
	}
}

bpm_je_general_strike_button_result_small = {
	value = 0
	add = institution:institution_police.investment
	multiply = 1
	min = 1
}

bpm_je_general_strike_button_result_normal = {
	value = 0
	add = institution:institution_police.investment
	multiply = 2
	min = 1
}

bpm_je_general_strike_button_result_large = {
	value = 0
	add = institution:institution_police.investment
	multiply = 4
	min = 1
}

### NATIONAL LIBERALS SPLIT ###
bpm_je_split_natlibs_progress_rate = {
	value = 0
	add = bpm_je_split_natlibs_progress_from_base
	add = bpm_je_split_natlibs_progress_from_conflicts
	add = bpm_je_split_natlibs_progress_from_liberals_empowered
	add = bpm_je_split_natlibs_progress_from_libcons_suppressed
	add = bpm_je_split_natlibs_progress_from_libcons_marginal
	if = {
		limit = {
			AND = {
				bpm_je_split_natlibs_progress_from_libcons_marginal = 0
				bpm_je_split_natlibs_progress_from_libcons_suppressed = 0
			}
		}
		add = bpm_je_split_natlibs_progress_from_radicals
	}
	if = {
		limit = {
			ruler = { interest_group = { is_interest_group_type = ig_national_liberals } }
		}
		add = 1000
	}
}
bpm_je_split_natlibs_progress_from_base = {
	value = 0
}
bpm_je_split_natlibs_progress_from_conflicts = {
	value = 0
	if = {
		limit = { is_at_war = yes }
		add = 0.5
	} else_if = { # Don't want wars to stack with diploplays here 
		limit = { is_diplomatic_play_committed_participant = yes }
		add = 0.2
	}
	if = {
		limit = { has_revolution = yes }
		add = 2.0
	}
	if = {
		limit = { bpm_country_is_major_unification_candidate = yes }
		add = 0.2
	}
}
bpm_je_split_natlibs_progress_from_liberals_empowered = {
	value = 0
	if = {
		limit = {
			OR = {
				AND = {
					exists = ig:ig_liberals
					ig:ig_liberals ?= { OR = { is_in_government = yes} }
				}
				AND = {
					exists = ig:ig_market_liberals
					ig:ig_market_liberals ?= { OR = { is_in_government = yes} }
				}
				AND = {
					exists = ig:ig_radicals
					ig:ig_radicals ?= { OR = { is_in_government = yes} }
				}
			}
		}
		add = 0.2
	}
}
bpm_je_split_natlibs_progress_from_libcons_suppressed = {
	value = 0
	# if = {
	# 	limit = { ig:ig_liberals ?= { is_being_suppressed = yes } }
	# 	add = -0.2
	# } 
	# if = {
	# 	limit = { ig:ig_conservatives ?= { is_being_suppressed = yes } }
	# 	add = -0.2
	# } 
}
bpm_je_split_natlibs_progress_from_libcons_marginal = {
	value = 0
	if = {
		limit = { ig:ig_liberals ?= { is_marginal = yes } }
		add = -0.1
	} 
	if = {
		limit = { ig:ig_conservatives ?= { is_marginal = yes } }
		add = -0.1
	} 
}
bpm_je_split_natlibs_progress_from_radicals = {	
	value = 1.0
	if = {
		limit = {
			radical_fraction = {
				value > 0.5
				strata = lower
			}
		}
		multiply = 0.5 
	} else_if = {
		limit = {
			radical_fraction = {
				value > 0.33
				strata = lower
			}
		}
		multiply = 0.25 
	} else_if = {
		limit = {
			radical_fraction = {
				value > 0.2
				strata = lower
			}
		}
		multiply = 0.1 
	} else_if = {
		limit = {
			radical_fraction = {
				value > 0.1
				strata = lower
			}
		}
		multiply = 0.05 
	} else = {
		multiply = 0.0 
	}
}

### MARKET LIBERALS SPLIT ###
bpm_je_split_marlibs_progress_rate = {
	value = 0
	add = bpm_je_split_marlibs_progress_from_base
	add = bpm_je_split_marlibs_progress_from_top_gp
	add = bpm_je_split_marlibs_progress_from_law_enactment
	add = bpm_je_split_marlibs_progress_from_movement
	# add = bpm_je_split_marlibs_progress_from_good_laws
	add = bpm_je_split_marlibs_progress_from_bad_laws
	add = bpm_je_split_marlibs_progress_from_patcons
	add = bpm_je_split_marlibs_progress_from_radcaps
}
bpm_je_split_marlibs_progress_from_base = {
	value = 0
}
bpm_je_split_marlibs_progress_from_top_gp = {
	value = 0
	if = {
		limit = {
			global_country_ranking = 1
		}
		add = 0.1
	}
}
bpm_je_split_marlibs_progress_from_law_enactment = {
	value = 0
	if = {
		limit = {
			OR = {
				is_enacting_law = law_type:law_commercialized_agriculture
				is_enacting_law = law_type:law_laissez_faire
				is_enacting_law = law_type:law_free_trade
			}
		}
		add = 0.6
	}
	if = {
		limit = {
			OR = {
				is_enacting_law = law_type:law_homesteading
				is_enacting_law = law_type:law_tenant_farmers
				is_enacting_law = law_type:law_interventionism
				is_enacting_law = law_type:law_protectionism
			}
		}
		add = 0.4
	}
}
bpm_je_split_marlibs_progress_from_movement = {
	value = 0
	if = {
		limit = {
			any_political_movement = {
				OR = { 
					is_political_movement_type = movement_bpm_liberal
					is_political_movement_type = movement_liberal
				}
			}
		}
		add = 0.4
	}
}
bpm_je_split_marlibs_progress_from_good_laws = {
	value = 0
	if = {
		limit = { has_law = law_type:law_homesteading	}
		add = 0.1
	}
	if = {
		limit = { has_law = law_type:law_interventionism	}
		add = 0.1
	}
	if = {
		limit = { has_law = law_type:law_protectionism	}
		add = 0.1
	}
}
bpm_je_split_marlibs_progress_from_bad_laws = {
	value = 0
	if = {
		limit = { has_law = law_type:law_serfdom }
		add = -0.5
	}
	if = {
		limit = { has_law = law_type:law_traditionalism	}
		add = -0.5
	}
}
bpm_je_split_marlibs_progress_from_patcons = {
	value = 0
	if = {
		limit = { has_variable = local_patcon_split_var }
		add = 0.5
	}
	if = {
		limit = { has_modifier = bpm_missouri_compromise }
		add = 0.5
	}

}
bpm_je_split_marlibs_progress_from_radcaps = {
	value = 0
	if = {
		limit = {
			radical_fraction = {
				value > 0.1
				pop_type = capitalists
			}
		}
		add = 0.1
	}
	else_if = {
		limit = {
			radical_fraction = {
				value > 0.3
				pop_type = capitalists
			}
		}
		add = 0.3
	}
}

### PATERNAL CONSERVATIVES SPLIT ###
bpm_je_split_patcons_progress_rate = {
	value = 0
	add = bpm_je_split_patcons_progress_from_base
	# add = bpm_je_split_patcons_progress_from_poverty
	add = bpm_je_split_patcons_progress_from_loyalists
	add = bpm_je_split_patcons_progress_from_radicals
	add = bpm_je_split_patcons_progress_from_conservative_status
	add = bpm_je_split_patcons_progress_from_left_wing_power
	add = bpm_je_split_patcons_progress_from_left_wing_government
	add = bpm_je_split_patcons_progress_from_communist_victory_coping
	add = bpm_je_split_patcons_progress_from_marlibs
	add = bpm_je_split_patcons_progress_from_corporatism
}
bpm_je_split_patcons_progress_from_base = {
	value = -0.1
}
bpm_je_split_patcons_progress_from_poverty = { # TODO: FIX THIS VALUE
	value = 0
}
bpm_je_split_patcons_progress_from_loyalists = {
	value = 0
	add = loyalist_fraction
	multiply = 2
}
bpm_je_split_patcons_progress_from_radicals = {
	value = 0
	add = radical_fraction
	multiply = 2
}
bpm_je_split_patcons_progress_from_conservative_status = {
	value = 0
	# if = {
	# 	limit = { ig:ig_conservatives ?= { is_being_suppressed = yes } }
	# 	add = 0.2
	# }
}
bpm_je_split_patcons_progress_from_left_wing_power = {
	value = 0
	every_interest_group = {
		limit = {
			bpm_ig_is_radical_left = yes 
			is_marginal = no
		}
		add = 0.1
	}
}
bpm_je_split_patcons_progress_from_left_wing_government = {
	value = 0
	if = {
		limit = { 
			ig:ig_conservatives ?= { is_in_government = no }
			any_interest_group = {
				bpm_ig_is_radical_left = yes
				is_in_government = yes
			}
		}
		add = 0.1
	}
}
bpm_je_split_patcons_progress_from_communist_victory_coping = {
	value = 0
	if = {
		limit = { has_law = law_type:law_council_republic }
		add = 3
	}
}
bpm_je_split_patcons_progress_from_marlibs = {
	value = 0
	if = {
		limit = { has_variable = local_marlib_split_var }
		add = 0.5
	}
}
bpm_je_split_patcons_progress_from_corporatism = {
	value = 0
	if = { 
		limit = { has_technology_researched = corporatism }
		add = 0.2
	}
}

### FASCISTS SPLIT ###
bpm_je_split_fascists_progress_rate = {
	value = 0
	add = bpm_je_split_fascists_progress_from_base
	add = bpm_je_split_fascists_progress_from_socialist_revolutions
	add = bpm_je_split_fascists_progress_from_socialist_countries
	add = bpm_je_split_fascists_progress_from_conflicts
	add = bpm_je_split_fascists_progress_from_rightists_empowered
	add = bpm_je_split_fascists_progress_from_rightists_suppressed
	add = bpm_je_split_fascists_progress_from_rightists_marginal
	if = {
		limit = {
			AND = {
				bpm_je_split_fascists_progress_from_rightists_marginal = 0
				bpm_je_split_fascists_progress_from_rightists_suppressed = 0
			}
		}
		add = bpm_je_split_fascists_progress_from_radicals
	}
}
bpm_je_split_fascists_progress_from_base = {
	value = 0
}
bpm_je_split_fascists_progress_from_socialist_revolutions = {
	value = 0
	if = {
		limit = { socialist_revolution_ongoing = yes }
		every_civil_war ={
			limit = { is_civil_war_type = revolution }
			add = civil_war_progress
		}
	}
}
bpm_je_split_fascists_progress_from_socialist_countries = {
	value = 0
	if = {
		limit = {
			any_country = {
				country_rank >= rank_value:major_power
				has_law = law_type:law_council_republic
			}
		}
		add = 1.0
	}
}
bpm_je_split_fascists_progress_from_conflicts = {
	value = 0
	if = {
		limit = { is_at_war = yes }
		add = 0.5
	} else_if = { # Don't want wars to stack with diploplays here 
		limit = { is_diplomatic_play_committed_participant = yes }
		add = 0.2
	}
	if = {
		limit = { has_revolution = yes }
		add = 2.0
	}
	if = {
		limit = { bpm_country_is_major_unification_candidate = yes }
		add = 0.2
	}
}
bpm_je_split_fascists_progress_from_rightists_empowered = {
	value = 0
	if = {
		limit = { ig:ig_reactionaries ?= { OR = { is_in_government = yes } } }
		add = 0.2
	}
	if = {
		limit = { ig:ig_conservatives ?= { OR = { is_in_government = yes } } }
		add = 0.2
	}
	if = {
		limit = { ig:ig_armed_forces = { OR = { is_in_government = yes } } }
		add = 0.2
	}
	if = {
		limit = { ig:ig_petty_bourgeoisie = { OR = { is_in_government = yes } } }
		add = 0.2
	}
}
bpm_je_split_fascists_progress_from_rightists_suppressed = {
	value = 0
	# if = {
	# 	limit = { ig:ig_reactionaries ?= { is_being_suppressed = yes } }
	# 	add = -0.2
	# }
	# if = {
	# 	limit = { ig:ig_conservatives ?= { is_being_suppressed = yes } }
	# 	add = -0.2
	# }
	# if = {
	# 	limit = { ig:ig_armed_forces = { is_being_suppressed = yes } }
	# 	add = -0.2
	# }
	# if = {
	# 	limit = { ig:ig_petty_bourgeoisie = { is_being_suppressed = yes } }
	# 	add = -0.2
	# }
}
bpm_je_split_fascists_progress_from_rightists_marginal = {
	value = 0
	if = {
		limit = { ig:ig_reactionaries ?= { is_marginal = yes } }
		add = -0.1
	}
	if = {
		limit = { ig:ig_conservatives ?= { is_marginal = yes } }
		add = -0.1
	}
	if = {
		limit = { ig:ig_armed_forces = { is_marginal = yes } }
		add = -0.1
	}
	if = {
		limit = { ig:ig_petty_bourgeoisie = { is_marginal = yes } }
		add = -0.1
	}
}
bpm_je_split_fascists_progress_from_radicals = {
	value = 1
	if = {
		limit = {
			radical_fraction = {
				value > 0.5
				strata = middle
			}
		}
		multiply = 0.5
	} else_if = {
		limit = {
			radical_fraction = {
				value > 0.33
				strata = middle
			}
		}
		multiply = 0.33
	} else_if = {
		limit = {
			radical_fraction = {
				value > 0.2
				strata = middle
			}
		}
		multiply = 0.2
	} else_if = {
		limit = {
			radical_fraction = {
				value > 0.1
				strata = middle
			}
		}
		multiply = 0.1
	} else = {
		multiply = 0.0
	}
}

bpm_movement_exhaustion_from_labor_ig_exhaustion = {
	value = 1
	every_supporting_interest_group = {
		limit = {
			bpm_ig_is_labor = yes
			has_variable = bpm_ig_exhaustion
		}
		add = {
			value = var:bpm_ig_exhaustion
			multiply = ig_clout
		}
	}
}

bpm_russia_rapid_bureaucratic_modernization_severity = {
	value = 1
	add = {
		limit = { has_modifier = bpm_russia_ad_hoc_governance }
		mult = 4
	}
	add = {
		limit = { has_modifier = bpm_russia_obschina }
		mult = 2
	}
	add = {
		limit = { has_modifier = bpm_russia_obschina_abolished }
		mult = 2
	}
	add = {
		limit = { has_modifier = bpm_russia_zemstvos }
		mult = 2
	}
	add = {
		limit = { has_modifier = bpm_russia_zemstvos_abolished }
		mult = 2
	}
}

bpm_je_modernizers_ideology_rate = {
	value = 0
	add = {
		desc = "BPM_VALUE_FROM_MODERNIZER_DIALECTIC_STRENGTH"
		add = bpm_je_modernizers_ideology_rate_modernizers
	}
	subtract = {
		desc = "BPM_VALUE_FROM_ANTI_MODERNIZER_DIALECTIC_STRENGTH"
		add = bpm_je_modernizers_ideology_rate_conservatives
	}
}

bpm_je_modernizers_ideology_rate_modernizers = {
	value = 0		
	subtract = {
		desc = "BPM_VALUE_FROM_MONARCH_POPULARITY_NEGATIVE"
		if = {
			limit = { 
				has_law = law_type:law_monarchy 
				ruler.popularity < 0
			}
			add = {
				value = ruler.popularity
				multiply = 0.01
			}
		}
	}

	add = {
		desc = "BPM_VALUE_FROM_LIBERAL_LEADER_AND_AGITATORS"
		every_scope_character = {
			limit = {
				is_interest_group_type = ig_liberals
				OR = {
					has_role = politician
					has_role = agitator
				}
			}
			add = popularity
		}
		multiply = 0.01
	}
	add = {
		desc = "BPM_VALUE_FROM_RADICAL_LEADER_AND_AGITATORS"
		every_scope_character = {
			limit = {
				is_interest_group_type = ig_radicals
				OR = {
					has_role = politician
					has_role = agitator
				}
			}
			add = popularity
		}
		multiply = 0.01
	}
	add = {
		desc = "BPM_VALUE_FROM_SOCIALIST_LEADER_AND_AGITATORS"
		every_scope_character = {
			limit = {
				is_interest_group_type = ig_socialists
				OR = {
					has_role = politician
					has_role = agitator
				}
			}
			add = popularity
		}
		multiply = 0.01
	}

	add = {
		desc = "BPM_VALUE_FROM_PRO_MODERNIZER_LOBBY_APPEASEMENT"
		every_political_lobby = {
			limit = {
				is_political_lobby_type = lobby_pro_country
				any_lobby_member = {
					OR = {
						is_interest_group_type = ig_liberals
						is_interest_group_type = ig_radicals
						is_interest_group_type = ig_socialists
					}
				}
			}
			add = appeasement
		}
		multiply = 0.25
		add = 0.0001
	}
	subtract = 0.0001

	add = {
		desc = "BPM_VALUE_FROM_PRO_MODERNIZER_LAW_PASSING"
		add = var:bpm_je_modernizers_liberal_laws_passed
		multiply = 0.25
		add = 0.0001
	}
	subtract = 0.0001

	add = {
		desc = "BPM_VALUE_FROM_PROMOTE_SECULAR_VALUES_LAW"
		add = 0.0001
		if = {
			limit = { has_modifier = bpm_repeatable_law_promote_secular_values_result }
			add = 1
		}
		multiply = 0.5
	}
	add = {
		desc = "BPM_VALUE_FROM_INVITE_FOREIGN_EXPERTS_LAW"
		add = 0.0001
		if = {
			limit = { has_modifier = bpm_repeatable_law_invite_foreign_experts_result }
			add = 1
		}
		multiply = 0.5
	}
	add = {
		desc = "BPM_VALUE_FROM_PROMOTE_DEMOCRATIC_VALUES_LAW"
		add = 0.0001
		if = {
			limit = { has_modifier = bpm_repeatable_law_promote_democratic_values_result }
			add = 1
		}
		multiply = 0.5
	}
	subtract = 0.00015
}

bpm_je_modernizers_ideology_rate_conservatives = {
	value = 0
	add = {
		desc = "BPM_VALUE_FROM_MONARCH_POPULARITY"
		if = {
			limit = { 
				has_law = law_type:law_monarchy 
				ruler.popularity < 0
			}
			add = {
				value = ruler.popularity
				multiply = 0.01
			}
		}
	}
	add = {
		desc = "BPM_VALUE_FROM_REACTIONARY_LEADER_AND_AGITATORS"
		every_scope_character = {
			limit = {
				is_interest_group_type = ig_reactionaries
				OR = {
					has_role = politician
					has_role = agitator
				}
			}
			add = popularity
		}
		multiply = 0.01
	}
	add = {
		desc = "BPM_VALUE_FROM_CONSERVATIVE_LEADER_AND_AGITATORS"
		every_scope_character = {
			limit = {
				is_interest_group_type = ig_conservatives
				OR = {
					has_role = politician
					has_role = agitator
				}
			}
			add = popularity
		}
		multiply = 0.01
	}

	add = {
		desc = "BPM_VALUE_FROM_PRO_CONSERVATIVE_LAW_PASSING"
		add = var:bpm_je_modernizers_conservative_laws_passed
		multiply = 0.25
		add = 0.0001
	}
	subtract = 0.0001

	add = {
		desc = "BPM_VALUE_FROM_ANTI_SECULAR_REACTION_LAW"
		add = 0.0001
		if = {
			limit = { has_modifier = bpm_repeatable_law_anti_secular_reaction_result }
			add = 1
		}
		multiply = 0.5
	}
	add = {
		desc = "BPM_VALUE_FROM_PARADES_AND_DRILLS_LAW"
		add = 0.0001
		if = {
			limit = { has_modifier = bpm_repeatable_law_parades_and_drills_result }
			add = 1
		}
		multiply = 0.5
	}
	add = {
		desc = "BPM_VALUE_FROM_PROMOTE_ABSOLUTIST_VALUES_LAW"
		add = 0.0001
		if = {
			limit = { has_modifier = bpm_repeatable_law_promote_absolutist_values_result }
			add = 1
		}
		multiply = 0.5
	}
	add = {
		desc = "BPM_VALUE_FROM_PROMOTE_STATE_RELIGION_LAW"
		add = 0.0001
		if = {
			limit = { has_modifier = bpm_repeatable_law_promote_state_religion_result }
			add = 1
		}
		multiply = 0.5
	}
	subtract = 0.0002
}

bpm_je_modernizers_dialectic_rate = {
	value = 0
	add = {
		value = bpm_je_modernizers_ideology_rate_modernizers
		max = bpm_je_modernizers_ideology_rate_conservatives
		desc = "BPM_VALUE_FROM_MODERNIZER_MINIMUM_BETWEEN_TWO_IDEOLOGIES"
	}

	add = {
		value = var:bpm_je_modernizers_copied_society_times
		multiply = 0.2
		desc = "BPM_VALUE_FROM_MODERNIZER_COPIED_SOCIETY_AMOUNT"
	} 

	subtract = {
		if = {
			limit = {
				has_law = law_type:law_censorship
			}
			add = institution:institution_culture.investment
		}
		multiply = 0.2
		desc = "BPM_VALUE_FROM_INSTITUTION_CENSORSHIP"
	}

	subtract = {
		if = {
			limit = {
				has_law = law_type:law_outlawed_dissent
			}
			add = institution:institution_culture.investment
		}
		multiply = 0.2
		desc = "BPM_VALUE_FROM_INSTITUTION_OUTLAWED_DISSENT"
	}

	subtract = {
		if = {
			limit = {					
				has_law = law_type:law_traditional_ostracism
			}
			add = 0.5
		}
		desc = "BPM_VALUE_FROM_LAW_TRADITIONAL_OSTRACISM"
	}
}
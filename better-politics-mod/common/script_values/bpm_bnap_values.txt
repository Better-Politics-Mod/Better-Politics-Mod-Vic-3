bpm_british_engagement_from_relations = {
    value = 0
    owner = {
        top_overlord = {
            add = relations:prev
        }
    }
    divide = 100
}

bpm_british_engagement_from_economic_dependence = {
    value = 0

    owner = {
        add = "economic_dependence(top_overlord)"
    }
    
    subtract = 1

    divide = 5

}

bpm_british_administrative_payments = {
    value = bpm_british_administrative_payments_percent

    multiply = expenses
}

bpm_british_administrative_payments_percent = {
    value = 1
    subtract = bpm_british_administrative_payment_debuff
    subtract = 0.25 # natural debuff
}

bpm_british_administrative_payment_debuff = {
    value = 0.25

    je:je_bpm_bnap_the_question_of_british_rule = {
        subtract = {
            value = "scripted_bar_progress(je_bpm_bnap_british_engagement_progress_bar)"
            divide = 400
        }
    }
}

bpm_british_administrative_payment_percent_for_tt = {
    add = {
        value = 0.5
        desc = "bpm_bnap_british_payments_percent_base_value"
    }

    add = {
        value = bpm_british_engagement
        divide = 400
        desc = "bpm_bnap_british_payments_percent_from_engagement"
    }
}

bpm_british_engagement = {
    value = 0

    je:je_bpm_bnap_the_question_of_british_rule = {
        add = {
            value = "scripted_bar_progress(je_bpm_bnap_british_engagement_progress_bar)"
        }
    }
}

bpm_british_engagement_from_administrative_payments = {
    value = 0

    owner = {
        add = bpm_british_engagement_from_administrative_payments_subcon
    }
}

bpm_british_engagement_from_administrative_payments_subcon = {
    value = bpm_british_administrative_payments

    top_overlord = {
        divide = income
    }
    subtract = 0.2 # if the cost is less than 20% of the income, the modifier is positive
    multiply = -2

    round_to = 0.1
}

bpm_bnap_income = {
    value = top_overlord.income
}
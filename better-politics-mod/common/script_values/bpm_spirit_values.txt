bpm_spirit_value = {
	value = 0
	if = {
		limit = {
			has_variable = bpm_spirit_var
		}
		add = var:bpm_spirit_var
	}
}

bpm_chaos_value = {
	value = 0
	if = {
		limit = {
			has_variable = bpm_chaos_var
		}
		add = var:bpm_chaos_var
	}
}

bpm_chaos_value_gui = {
	value = bpm_chaos_value
	multiply = 100
}

bpm_spirit_value_change = {
	value = bpm_spirit_max_value
	multiply = bpm_spirit_gain_weekly_per_max
	min = bpm_spirit_gain_min
}

bpm_chaos_value_change = {
	value = 1

	every_interest_group = {
		limit = {
			OR = {
				is_powerful = yes
				is_in_government = yes
				owner.ruler.interest_group = this
			}
		}

		add = {
			value = ig_clout
			multiply = ig_approval
			if = {
				limit = { 
					owner = {
						ruler.interest_group = this
						NOT = {
							has_law = law_type:law_anarchy
						}
					}
				}
				multiply = 5
			}
		}

		multiply = 0.1
	}

	min = -1
	max = 5

	multiply = -0.01 # Normalizing to a % value
}

bpm_chaos_value_change_gui = {
	value = bpm_chaos_value_change
	multiply = 100
}

bpm_spirit_max_value = {
	value = bpm_spirit_storage_max
	subtract = bpm_spirit_storage_min

	multiply = {
		value = 1
		subtract = bpm_chaos_ratio_to_max
	}

	add = bpm_spirit_storage_min
}

bpm_chaos_ratio_to_max = {
	value = bpm_chaos_value
	subtract = bpm_chaos_min

	divide = {
		value = bpm_chaos_max
		subtract = bpm_chaos_min
	}
}

bpm_spirit_surplus = {
	value = 0
	if = {
		limit = {
			bpm_spirit_value > 0
		}
		add = bpm_spirit_value
		divide = bpm_spirit_max_value
	}
}

bpm_spirit_deficit = {
	value = 0
	if = {
		limit = {
			bpm_spirit_value < 0
		}
		add = bpm_spirit_value
		divide = bpm_spirit_max_value
	}
}

bpm_spirit_sway_cost = {
	value = 100

	#if = {
	#	limit = {
	#		bpm_ig_law_support_total_value < 0
	#	}
	#	subtract = bpm_ig_law_support_total_value
	#	multiply = 50
	#}

	multiply = ig_clout

	floor = yes

	multiply = 10

	max = 500
	min = 50
}

bpm_chaos_sway_cost = {
	value = bpm_spirit_sway_cost
	multiply = bpm_chaos_per_spirit_spent
	multiply = 100
	floor = yes
}

bpm_chaos_amount_small = {
	value = bpm_spirit_amount_small
	multiply = bpm_chaos_per_spirit_spent
	multiply = 100
	floor = yes
}

bpm_chaos_amount_large = {
	value = bpm_spirit_amount_large
	multiply = bpm_chaos_per_spirit_spent
	multiply = 100
	floor = yes
}

bpm_chaos_amount_huge = {
	value = bpm_spirit_amount_huge
	multiply = bpm_chaos_per_spirit_spent
	multiply = 100
	floor = yes
}